
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <title>jjmodel.plotting &#8212; jjmodel 0.1 documentation</title>
    <link rel="stylesheet" href="../../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for jjmodel.plotting</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Created on Mon Apr 25 19:10:51 2016</span>

<span class="sd">@author: Skevja</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> 
<span class="kn">from</span> <span class="nn">scipy.ndimage</span> <span class="kn">import</span> <span class="n">zoom</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.collections</span> <span class="kn">import</span> <span class="n">LineCollection</span>
<span class="kn">from</span> <span class="nn">.iof</span> <span class="kn">import</span> <span class="n">tab_sorter</span><span class="p">,</span> <span class="n">tab_reader</span><span class="p">,</span> <span class="n">TabSaver</span>
<span class="kn">from</span> <span class="nn">.constants</span> <span class="kn">import</span> <span class="n">KM</span><span class="p">,</span> <span class="n">SIGMA_E</span><span class="p">,</span> <span class="n">tp</span>
<span class="kn">from</span> <span class="nn">.tools</span> <span class="kn">import</span> <span class="n">Timer</span>
<span class="kn">from</span> <span class="nn">.control</span> <span class="kn">import</span> <span class="p">(</span><span class="n">inpcheck_radius</span><span class="p">,</span><span class="n">inpcheck_age</span><span class="p">,</span><span class="n">inpcheck_dz</span><span class="p">,</span><span class="n">inpcheck_height</span><span class="p">,</span><span class="n">inpcheck_iskwargtype</span><span class="p">,</span>
                     <span class="n">inpcheck_kwargs</span><span class="p">,</span><span class="n">inpcheck_mode_comp</span><span class="p">,</span><span class="n">reduce_kwargs</span><span class="p">,</span><span class="n">inpcheck_kwargs_compatibility</span><span class="p">)</span>
<span class="kn">from</span> <span class="nn">.analysis</span> <span class="kn">import</span> <span class="p">(</span><span class="n">rhoz_monoage</span><span class="p">,</span><span class="n">rhoz_monomet</span><span class="p">,</span><span class="n">metz</span><span class="p">,</span><span class="n">metr</span><span class="p">,</span><span class="n">rhor_monoage</span><span class="p">,</span><span class="n">rhor_monomet</span><span class="p">,</span><span class="n">agehist</span><span class="p">,</span>
                       <span class="n">methist</span><span class="p">,</span><span class="n">hr_monoage</span><span class="p">,</span><span class="n">hr_monomet</span><span class="p">,</span><span class="n">sigwz</span><span class="p">,</span><span class="n">sigwr</span><span class="p">,</span><span class="n">sigwr_monoage</span><span class="p">,</span><span class="n">sigwr_monomet</span><span class="p">,</span><span class="n">rz_map</span><span class="p">,</span> 
                       <span class="n">rz_map_quantity</span><span class="p">,</span><span class="n">agez</span><span class="p">,</span><span class="n">ager</span><span class="p">,</span><span class="n">rhor</span><span class="p">,</span><span class="n">fw_hist</span><span class="p">,</span><span class="n">disk_brightness</span><span class="p">,</span><span class="n">hess_simple</span><span class="p">,</span><span class="n">fi_iso</span><span class="p">,</span> 
                       <span class="n">rot_curve</span><span class="p">)</span>                       



<div class="viewcode-block" id="Plotting"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting">[docs]</a><span class="k">class</span> <span class="nc">Plotting</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class for plotting. </span>
<span class="sd">    All methods of this class return figure and axes (f, ax).        </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="Plotting.__init__"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">inp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Class instance is initialized by three basic parameters. </span>
<span class="sd">        </span>
<span class="sd">        :param p: Set of model parameters from the parameter file. </span>
<span class="sd">        :type p: namedtuple</span>
<span class="sd">        :param a: Collection of the fixed model parameters, useful quantities, and arrays.</span>
<span class="sd">        :type a: namedtuple</span>
<span class="sd">        :param inp: Collection of the input functions including SFR, AVR, AMR, and IMF.</span>
<span class="sd">        :type inp: dict  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp</span> <span class="o">=</span> <span class="n">p</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">inp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;g1&#39;</span><span class="p">,</span><span class="s1">&#39;g2&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;dh&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">labs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{Thin \ disk}$&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{Thick \ disk}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;g1&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{Molecular \ gas}$&#39;</span><span class="p">,</span> <span class="s1">&#39;g2&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{Atomic \ gas}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;dh&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{DM \ halo}$&#39;</span><span class="p">,</span> <span class="s1">&#39;sh&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{Stellar \ halo}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;r0&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{R_\odot=}$&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{\ kpc}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;dt&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{Total \ disk}$&#39;</span><span class="p">,</span> <span class="s1">&#39;tot&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{Total \ disk + halo}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm</span><span class="si">{Bulge}</span><span class="s1">$&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pops</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rc&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{RC \ stars}$&#39;</span><span class="p">,</span> <span class="s1">&#39;rc+&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{RC+HGB \ stars}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{A \ stars}$&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{F \ stars}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;gdw&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{G \ dwarfs}$&#39;</span><span class="p">,</span> <span class="s1">&#39;kdw&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{K \ dwarfs}$&#39;</span><span class="p">,</span>                     
                     <span class="s1">&#39;mdw&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{M \ dwarfs}$&#39;</span><span class="p">,</span><span class="s1">&#39;ceph&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{Cepheids \ Type \ I}$&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">popcols</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;rc&#39;</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span> <span class="s1">&#39;rc+&#39;</span><span class="p">:</span><span class="s1">&#39;tomato&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;a&#39;</span><span class="p">:</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="s1">&#39;f&#39;</span><span class="p">:</span><span class="s1">&#39;steelblue&#39;</span><span class="p">,</span>
                        <span class="s1">&#39;gdw&#39;</span><span class="p">:</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="s1">&#39;kdw&#39;</span><span class="p">:</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span><span class="s1">&#39;ceph&#39;</span><span class="p">:</span><span class="s1">&#39;indigo&#39;</span>                   
                        <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cols</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;d&#39;</span><span class="p">:</span><span class="s1">&#39;dodgerblue&#39;</span><span class="p">,</span><span class="s1">&#39;g1&#39;</span><span class="p">:</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span><span class="s1">&#39;g2&#39;</span><span class="p">:</span><span class="s1">&#39;lawngreen&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;dh&#39;</span><span class="p">:</span><span class="s1">&#39;darkmagenta&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">:</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">:</span><span class="s1">&#39;violet&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">:</span><span class="s1">&#39;y&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;r&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{R, \ kpc}$&#39;</span><span class="p">,</span> <span class="s1">&#39;t&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{t, \ Gyr}$&#39;</span><span class="p">,</span>                          
                     <span class="s1">&#39;tau&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{\tau, \ Gyr}$&#39;</span><span class="p">,</span> <span class="s1">&#39;num&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{N, \ pc^{-2}}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;sigma&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{\Sigma, \ M_\odot \ pc^{-2}}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{|z|, \ pc}$&#39;</span><span class="p">,</span> <span class="s1">&#39;zkpc&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{|z|, \ kpc}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;h&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{h, \ pc}$&#39;</span><span class="p">,</span> <span class="s1">&#39;nsfr&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{SFR/&lt;SFR&gt;}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;rho&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{\rho, \ M_\odot \ pc^{-3}}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;sigw&#39;</span><span class="p">:</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{\sigma_W, \ km \ s^{-1}}$&#39;</span><span class="p">,</span> <span class="s1">&#39;fe&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{[Fe/H]}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;kz&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{K_{|z|}, \ km^2 \ s^{-2} \ kpc^{-1}}$&#39;</span><span class="p">,</span>
                     <span class="s1">&#39;n&#39;</span><span class="p">:</span><span class="s1">&#39;$\mathrm{N, \ pc^{-3}}$&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xt</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;ticks&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">tp</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span>
                   <span class="s1">&#39;labels&#39;</span><span class="p">:[</span><span class="s1">&#39;0&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;2&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;4&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;6&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;8&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;10&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="s1">&#39;12&#39;</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">]</span> <span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lw</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;main&#39;</span><span class="p">:</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;secondary&#39;</span><span class="p">:</span><span class="mi">1</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fnt</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;main&#39;</span><span class="p">:</span><span class="mi">14</span><span class="p">,</span><span class="s1">&#39;secondary&#39;</span><span class="p">:</span><span class="mi">11</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cmaps</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;r&#39;</span><span class="p">:</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet_r</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">jet</span><span class="p">,</span><span class="s1">&#39;tau&#39;</span><span class="p">:</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gnuplot</span><span class="p">,</span><span class="s1">&#39;feh&#39;</span><span class="p">:</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">gnuplot2_r</span><span class="p">,</span>
                      <span class="s1">&#39;dens&#39;</span><span class="p">:</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">magma</span><span class="p">,</span><span class="s1">&#39;viridis&#39;</span><span class="p">:</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">viridis</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cmapnames</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;r&#39;</span><span class="p">:</span><span class="s1">&#39;jet_r&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">:</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span><span class="s1">&#39;tau&#39;</span><span class="p">:</span><span class="s1">&#39;gnuplot&#39;</span><span class="p">,</span><span class="s1">&#39;feh&#39;</span><span class="p">:</span><span class="s1">&#39;gnuplot2_r&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;dens&#39;</span><span class="p">:</span><span class="s1">&#39;magma&#39;</span><span class="p">,</span><span class="s1">&#39;viridis&#39;</span><span class="p">:</span><span class="s1">&#39;viridis&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cbar_settings</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;FeH&#39;</span><span class="p">:[</span><span class="mf">0.2</span><span class="p">,[</span><span class="o">-</span><span class="mf">2.5</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;fe&#39;</span><span class="p">]],</span>
                              <span class="s1">&#39;sigw&#39;</span><span class="p">:[</span><span class="mi">10</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigw&#39;</span><span class="p">]],</span>
                              <span class="s1">&#39;logg&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="s1">&#39;$\mathrm</span><span class="si">{logg}</span><span class="s1">$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;logL&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">],</span><span class="s1">&#39;$\mathrm</span><span class="si">{logL}</span><span class="s1">$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;logT&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="s1">&#39;$\mathrm</span><span class="si">{logT}</span><span class="s1">$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;Mf&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="s1">&#39;$\mathrm{M_f, \ M_\odot}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;Mini&#39;</span><span class="p">:[</span><span class="mi">1</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="s1">&#39;$\mathrm{M_</span><span class="si">{ini}</span><span class="s1">, \ M_\odot}$&#39;</span><span class="p">],</span>                   
                              <span class="s1">&#39;U&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{U, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;B&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{B, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;V&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{V, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;R&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{R, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;I&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{I, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;K&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{K, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;H&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{H, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;J&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{J, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;G_DR2&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{G\_DR2, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;GBPbr_DR2&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{GBPbr\_DR2, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;GBPft_DR2&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{GBPft\_DR2, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;GRP_DR2&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{GRP\_DR2, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;G_EDR3&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{G\_EDR3, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;GBP_EDR3&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{GBP\_EDR3, \ mag}$&#39;</span><span class="p">],</span>
                              <span class="s1">&#39;GRP_EDR3&#39;</span><span class="p">:[</span><span class="mi">2</span><span class="p">,[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span><span class="mi">20</span><span class="p">],</span><span class="s1">&#39;$\mathrm{GRP\_EDR3, \ mag}$&#39;</span><span class="p">]}</span>                             
        <span class="n">label_size</span> <span class="o">=</span> <span class="mi">12</span>
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_size</span> 
        <span class="n">mpl</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">label_size</span> </div>
    
    
    <span class="k">def</span> <span class="nf">_figclose_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Closes figure. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            

    <span class="k">def</span> <span class="nf">_figformat_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns figure format (defualt png or other if specified in kwargs).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;save_format&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;save_format&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fmt</span> <span class="o">=</span> <span class="s1">&#39;png&#39;</span>
        <span class="k">return</span> <span class="n">fmt</span>
    

    <span class="k">def</span> <span class="nf">_figsave_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Saves figure with the name figname.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">figname</span><span class="p">)</span>
            
        
    <span class="k">def</span> <span class="nf">_figcolorbar_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">default</span><span class="p">,</span><span class="n">nbins_default</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Creates colorbar (continious or binned).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;cbar&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;cbar_bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
                <span class="n">colorbar</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cbar&#39;</span><span class="p">],</span><span class="nb">int</span><span class="p">(</span><span class="n">nbins_default</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">colorbar</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cbar&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;cbar_bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
                <span class="n">colorbar</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">get_cmap</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cmapnames</span><span class="p">[</span><span class="n">default</span><span class="p">],</span><span class="nb">int</span><span class="p">(</span><span class="n">nbins_default</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span> 
                <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cmaps</span><span class="p">[</span><span class="n">default</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">colorbar</span> 
    
    
    <span class="k">def</span> <span class="nf">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">cmin</span><span class="p">,</span><span class="n">cmax</span><span class="p">,</span><span class="n">dc</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Calculates correct min and max values for the colorbar </span>
<span class="sd">        (depend on whether the colorbar is continious or binned).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;cbar_bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
            <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="n">cmin</span> <span class="o">-</span> <span class="n">dc</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">+</span> <span class="n">dc</span><span class="o">/</span><span class="mi">2</span>  
        <span class="k">return</span> <span class="p">(</span><span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span><span class="p">)</span>
    
  
    <span class="k">def</span> <span class="nf">_dynamic_ylim_log_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">array</span><span class="p">,</span><span class="n">yminmax_default</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Finds the range to be displayed on the plot axis for the data in array (log scale). </span>
<span class="sd">        Array has multiple columns. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">ymind</span><span class="p">,</span> <span class="n">ymaxd</span> <span class="o">=</span> <span class="n">yminmax_default</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
                <span class="n">ar_mins</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nx</span><span class="p">)]</span>
                <span class="n">ar_maxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nx</span><span class="p">)]</span>
                <span class="n">ar_mins_clean</span><span class="p">,</span> <span class="n">ar_maxs_clean</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> 
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">ar_mins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ar_mins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">ar_mins_clean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ar_mins</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">ar_maxs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">!=</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">ar_maxs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">ar_maxs_clean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ar_maxs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">minmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">ar_mins_clean</span><span class="p">)</span>
            <span class="n">maxmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">ar_maxs_clean</span><span class="p">)</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">minmin</span><span class="p">)</span><span class="o">//</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="mi">10</span><span class="o">**</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">maxmax</span><span class="p">)</span><span class="o">//</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ymin</span> <span class="o">&lt;</span> <span class="n">ymind</span><span class="p">:</span> 
                <span class="n">ymin</span> <span class="o">=</span> <span class="n">ymind</span>
        <span class="k">except</span><span class="p">:</span> 
            <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymind</span><span class="p">,</span> <span class="n">ymaxd</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
    
    
    <span class="k">def</span> <span class="nf">_dynamic_ylim_lin_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">array</span><span class="p">,</span><span class="n">yminmax_default</span><span class="p">,</span><span class="n">factor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Finds the range to be displayed on the plot axis for the data in array (linear scale). </span>
<span class="sd">        Array has multiple columns. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">nx</span><span class="p">,</span> <span class="n">ny</span> <span class="o">=</span> <span class="n">array</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">ymind</span><span class="p">,</span> <span class="n">ymaxd</span> <span class="o">=</span> <span class="n">yminmax_default</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
                <span class="n">ar_mins</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nx</span><span class="p">)]</span>
                <span class="n">ar_maxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nx</span><span class="p">)]</span>
                <span class="n">ar_mins_clean</span><span class="p">,</span> <span class="n">ar_maxs_clean</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span> 
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nx</span><span class="p">):</span>
                    <span class="k">if</span> <span class="n">ar_mins</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">ar_mins_clean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ar_mins</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                    <span class="k">if</span> <span class="n">ar_maxs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mi">0</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                        <span class="n">ar_maxs_clean</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ar_maxs</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">minmin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">ar_mins_clean</span><span class="p">)</span>
            <span class="n">maxmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">ar_maxs_clean</span><span class="p">)</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="p">(</span><span class="n">minmin</span><span class="o">//</span><span class="n">factor</span><span class="p">)</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="p">(</span><span class="n">factor</span><span class="o">*</span><span class="p">(</span><span class="n">maxmax</span><span class="o">//</span><span class="n">factor</span><span class="p">)</span> <span class="o">+</span> <span class="n">factor</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ymin</span> <span class="o">&lt;</span> <span class="n">ymind</span><span class="p">:</span> 
                <span class="n">ymin</span> <span class="o">=</span> <span class="n">ymind</span>
            <span class="k">if</span> <span class="n">ymax</span> <span class="o">&gt;</span> <span class="n">ymaxd</span><span class="p">:</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymaxd</span>
        <span class="k">except</span><span class="p">:</span> 
            <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymind</span><span class="p">,</span> <span class="n">ymaxd</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">_dynamic_ylim_1d_lin_</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">array</span><span class="p">,</span><span class="n">yminmax_default</span><span class="p">,</span><span class="n">factor</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Finds the range to be displayed on the plot axis for the data in array (linear scale). </span>
<span class="sd">        Array has one column. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ymind</span><span class="p">,</span> <span class="n">ymaxd</span> <span class="o">=</span> <span class="n">yminmax_default</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="ne">RuntimeWarning</span><span class="p">)</span>
                <span class="n">mins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> 
                <span class="n">maxs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">array</span><span class="p">)</span> 
            <span class="n">ymin</span> <span class="o">=</span> <span class="n">factor</span><span class="o">*</span><span class="p">(</span><span class="n">mins</span><span class="o">//</span><span class="n">factor</span><span class="p">)</span> 
            <span class="n">ymax</span> <span class="o">=</span> <span class="p">(</span><span class="n">factor</span><span class="o">*</span><span class="p">(</span><span class="n">maxs</span><span class="o">//</span><span class="n">factor</span><span class="p">)</span> <span class="o">+</span> <span class="n">factor</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">ymin</span> <span class="o">&lt;</span> <span class="n">ymind</span><span class="p">:</span> 
                <span class="n">ymin</span> <span class="o">=</span> <span class="n">ymind</span>
            <span class="k">if</span> <span class="n">ymax</span> <span class="o">&gt;</span> <span class="n">ymaxd</span><span class="p">:</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymaxd</span>
        <span class="k">except</span><span class="p">:</span> 
            <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymind</span><span class="p">,</span> <span class="n">ymaxd</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
    
    
<div class="viewcode-block" id="Plotting.rhor_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.rhor_plt">[docs]</a>    <span class="k">def</span> <span class="nf">rhor_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Radial density profiles of the Galactic components </span>
<span class="sd">        (thin and thick disk, molecular and atomic gas, DM and stellar halo). </span>
<span class="sd">        </span>
<span class="sd">        :param sigma: Optional. If True, surface density profiles (:math:`\mathrm{M_\odot \ pc^{-2}}`) will be plotted. </span>
<span class="sd">            By default, the plot displayes midplane densities (:math:`\mathrm{M_\odot \ pc^{-3}}`). </span>
<span class="sd">        :type sigma: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved (call ``a.T[&#39;inpplt&#39;]`` </span>
<span class="sd">            to display the folder name).</span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;sigma&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;sigma&#39;</span><span class="p">])</span>
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">rho_r</span><span class="p">,</span> <span class="n">rho_r0</span> <span class="o">=</span> <span class="n">rhor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>

        <span class="n">round_eval</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.1e</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">round_eval</span> <span class="o">=</span> <span class="s2">&quot;</span><span class="si">%.2e</span><span class="s2">&quot;</span>
            <span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_log_</span><span class="p">(</span><span class="n">rho_r</span><span class="p">,[</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">350</span><span class="p">])</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span>
            <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;inpplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;SigmaR.&#39;</span><span class="p">,</span><span class="n">format_</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_log_</span><span class="p">(</span><span class="n">rho_r</span><span class="p">,[</span><span class="mf">1e-5</span><span class="p">,</span><span class="mf">1e2</span><span class="p">])</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">]</span>
            <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;inpplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;RhoR.&#39;</span><span class="p">,</span><span class="n">format_</span><span class="p">)))</span>
        
        <span class="n">f</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">rho_r</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                         <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>      
            <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">rho_r0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                         <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1.01</span><span class="o">*</span><span class="n">rho_r0</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="nb">str</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">round_eval</span> <span class="o">%</span> <span class="p">(</span><span class="n">rho_r0</span><span class="p">[</span><span class="n">i</span><span class="p">]))),</span>
                    <span class="n">fontsize</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span>
                     <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]},</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>
        
    
<div class="viewcode-block" id="Plotting.nsfr_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.nsfr_plt">[docs]</a>    <span class="k">def</span> <span class="nf">nsfr_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalized star formation rate (NSFR) as a function of Galactocentric distance. </span>
<span class="sd">                </span>
<span class="sd">        :param mode_comp: Galactic component. Can be ``&#39;d&#39;`` (thin disk), ``&#39;t&#39;`` (thick disk), or </span>
<span class="sd">            ``&#39;dt&#39;`` (thin + thick disk).</span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :type cbar_bins: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved (call ``a.T[&#39;inpplt&#39;]`` </span>
<span class="sd">            to display the folder name).</span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span><span class="s1">&#39;SFR&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;t&#39;</span> <span class="ow">and</span> <span class="p">((</span><span class="s1">&#39;cbar&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> 
                                <span class="p">(</span><span class="s1">&#39;cbar_bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">))):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_function</span> <span class="o">+</span> <span class="s2">&quot;: Unnecessary input. Keywords &#39;cbar&#39; and &#39;cbar_bins&#39;&quot;</span><span class="o">+</span>\
                                  <span class="s2">&quot; don&#39;t work with mode_comp=&#39;t&#39;.&quot;</span><span class="p">)</span>
                  
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;nsfr&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.82</span><span class="p">,</span><span class="mf">0.85</span><span class="p">,</span><span class="n">ln</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">!=</span><span class="s1">&#39;t&#39;</span><span class="p">:</span>
            <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
                <span class="n">NSFR</span><span class="p">,</span> <span class="n">NSFR0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;NSFRd&#39;</span><span class="p">,</span><span class="s1">&#39;NSFRd0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">NSFR</span><span class="p">,</span> <span class="n">NSFR0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;NSFRtot&#39;</span><span class="p">,</span><span class="s1">&#39;NSFRtot0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">NSFR</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.2</span>
            <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">NSFR</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">NSFR</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R_array</span><span class="p">],</span>
                                           <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>
                                           <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                       
                                           <span class="p">)</span>                                      
            <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">NSFR0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">NSFR0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">NSFR</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;NSFRt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">NSFR</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.01</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">NSFR</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">NSFR</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;inpplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;NSFR_&#39;</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">format_</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>        </div>
    

<div class="viewcode-block" id="Plotting.nsfr_rsun_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.nsfr_rsun_plt">[docs]</a>    <span class="k">def</span> <span class="nf">nsfr_rsun_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Normalized star formation rate (NSFR) for the Solar neighbourhood, ``p.Rsun``.</span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component. Can be ``&#39;d&#39;`` (thin disk), ``&#39;t&#39;`` (thick disk), or </span>
<span class="sd">            ``&#39;dt&#39;`` (thin + thick disk).</span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved (call ``a.T[&#39;inpplt&#39;]`` </span>
<span class="sd">            to display the folder name).</span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span><span class="s1">&#39;SFR&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
                  
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;nsfr&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.91</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">!=</span><span class="s1">&#39;t&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
                <span class="n">NSFRd0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;NSFRd0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">NSFRd0</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.2</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">NSFRd0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">NSFRd0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">NSFRtot0</span><span class="p">,</span><span class="n">SFRt0</span><span class="p">,</span><span class="n">SFRd0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;NSFRtot0&#39;</span><span class="p">,</span><span class="s1">&#39;SFRt0&#39;</span><span class="p">,</span><span class="s1">&#39;SFRd0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                <span class="n">SFRdt_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">SFRt0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">SFRd0</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">jt</span><span class="p">],</span>
                                                     <span class="n">SFRd0</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">jt</span><span class="p">:]),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
                <span class="n">NSFRd0</span> <span class="o">=</span> <span class="n">SFRd0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">SFRdt_mean</span>
                <span class="n">NSFRt0</span> <span class="o">=</span> <span class="n">SFRt0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">SFRdt_mean</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">NSFRtot0</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.2</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SFRd0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">NSFRd0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">SFRt0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">NSFRt0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">NSFRtot0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">NSFRtot0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">NSFR</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;NSFRt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">NSFR</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.01</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">NSFR</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">NSFR</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;inpplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;NSFR_R&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">),</span><span class="s1">&#39;_&#39;</span><span class="p">,</span>
                                                           <span class="n">mode_comp</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">format_</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>        </div>

    
<div class="viewcode-block" id="Plotting.amrr_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.amrr_plt">[docs]</a>    <span class="k">def</span> <span class="nf">amrr_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Age-metallicity relation (AMR) of the disk as a function of Galactocentric distance.</span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component. Can be ``&#39;d&#39;`` (thin disk), ``&#39;t&#39;`` (thick disk), or </span>
<span class="sd">            ``&#39;dt&#39;`` (thin + thick disk).</span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :type cbar_bins: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved (call ``a.T[&#39;inpplt&#39;]`` </span>
<span class="sd">            to display the folder name).</span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span><span class="s1">&#39;AMR&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">merged</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;t&#39;</span> <span class="ow">and</span> <span class="p">((</span><span class="s1">&#39;cbar&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> 
                                <span class="p">(</span><span class="s1">&#39;cbar_bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">))):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_function</span> <span class="o">+</span> <span class="s2">&quot;: Unnecessary input. Keywords &#39;cbar&#39; and &#39;cbar_bins&#39;&quot;</span><span class="o">+</span>\
                                  <span class="s2">&quot; don&#39;t work with mode_comp=&#39;t&#39;.&quot;</span><span class="p">)</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;fe&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">!=</span><span class="s1">&#39;t&#39;</span><span class="p">:</span>
            <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.76</span><span class="p">,</span><span class="mf">0.18</span><span class="p">,</span><span class="n">ln</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
                <span class="n">AMR</span><span class="p">,</span> <span class="n">AMR0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;AMRd&#39;</span><span class="p">,</span><span class="s1">&#39;AMRd0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">AMR</span><span class="p">,</span> <span class="n">AMR0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;AMRd&#39;</span><span class="p">,</span><span class="s1">&#39;AMRd0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
                <span class="n">AMRt</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;AMRt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">AMR</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">AMR</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R_array</span><span class="p">],</span>
                                           <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>
                                           <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                       
                                           <span class="p">)</span>                                      
            <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AMR0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">AMR0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AMRt</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">jt</span><span class="p">],</span><span class="n">AMRt</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">jt</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                        <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">AMR</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;AMRt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AMR</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">jt</span><span class="p">],</span><span class="n">AMR</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">jt</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_lin_</span><span class="p">(</span><span class="n">AMR</span><span class="p">[</span><span class="mi">1</span><span class="p">:],[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">],</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;inpplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;AMR_&#39;</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">format_</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>     </div>
    

<div class="viewcode-block" id="Plotting.amr_rsun_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.amr_rsun_plt">[docs]</a>    <span class="k">def</span> <span class="nf">amr_rsun_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Age-metallicity relation (AMR) for the Solar neighbourhood, ``p.Rsun``.</span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component. Can be ``&#39;d&#39;`` (thin disk), ``&#39;t&#39;`` (thick disk), or </span>
<span class="sd">            ``&#39;dt&#39;`` (thin + thick disk).</span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved (call ``a.T[&#39;inpplt&#39;]`` </span>
<span class="sd">            to display the folder name).</span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes.       </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span><span class="s1">&#39;AMR&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">merged</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;fe&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.91</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">!=</span><span class="s1">&#39;t&#39;</span><span class="p">:</span>            
            <span class="n">AMR</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;AMRd0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AMR</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">AMR</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">])</span>
            <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_lin_</span><span class="p">(</span><span class="n">AMR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">AMR</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="mi">1</span><span class="p">),[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">],</span><span class="mf">0.2</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span><span class="p">:</span>
                <span class="n">AMRt0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;AMRt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AMRt0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">AMRt0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span>
                        <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
                <span class="n">AMRt0_long</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">AMRt0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">AMRt0</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                             <span class="n">AMRt0</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">jd</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">jt</span><span class="p">)),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_lin_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">AMR</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">AMRt0_long</span><span class="p">),</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
                                                     <span class="p">[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">],</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">AMR</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;AMRt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AMR</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">AMR</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
            <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_lin_</span><span class="p">(</span><span class="n">AMR</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">AMR</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="mi">1</span><span class="p">),[</span><span class="o">-</span><span class="mf">1.5</span><span class="p">,</span><span class="mf">1.0</span><span class="p">],</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;inpplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;AMR_R&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">),</span><span class="s1">&#39;_&#39;</span><span class="p">,</span>
                                                           <span class="n">mode_comp</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">format_</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>     </div>


<div class="viewcode-block" id="Plotting.gr_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.gr_plt">[docs]</a>    <span class="k">def</span> <span class="nf">gr_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mass loss as a function of time and Galactocentric distance.</span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component. Can be ``&#39;d&#39;`` (thin disk), ``&#39;t&#39;`` (thick disk), or </span>
<span class="sd">            ``&#39;dt&#39;`` (thin + thick disk).</span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :type cbar_bins: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved (call ``a.T[&#39;inpplt&#39;]`` </span>
<span class="sd">            to display the folder name).</span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;mass loss&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">merged</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="p">(</span><span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;t&#39;</span> <span class="ow">and</span> <span class="p">((</span><span class="s1">&#39;cbar&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> 
                                <span class="p">(</span><span class="s1">&#39;cbar_bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">))):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_function</span> <span class="o">+</span> <span class="s2">&quot;: Unnecessary input. Keywords &#39;cbar&#39; and &#39;cbar_bins&#39;&quot;</span><span class="o">+</span>\
                                  <span class="s2">&quot; don&#39;t work with mode_comp=&#39;t&#39;.&quot;</span><span class="p">)</span>
                
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mf">0.6</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm{Mass \ fraction \ in \ stars \ and \ remnants}$&#39;</span><span class="p">,</span>
                      <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">!=</span><span class="s1">&#39;t&#39;</span><span class="p">:</span>
            <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.4</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="n">ln</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
                <span class="n">g</span><span class="p">,</span> <span class="n">g0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;gd&#39;</span><span class="p">,</span><span class="s1">&#39;gd0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">g</span><span class="p">,</span> <span class="n">g0</span><span class="p">,</span> <span class="n">gt</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;gd&#39;</span><span class="p">,</span><span class="s1">&#39;gd0&#39;</span><span class="p">,</span><span class="s1">&#39;gt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
            <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">g</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">g</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R_array</span><span class="p">],</span>
                                           <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>
                                           <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                       
                                           <span class="p">)</span>                                      
            <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">g0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">g0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">!=</span><span class="s1">&#39;d&#39;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">gt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gt</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;gt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">gt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;inpplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;g_&#39;</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">format_</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>         </div>


<div class="viewcode-block" id="Plotting.g_rsun_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.g_rsun_plt">[docs]</a>    <span class="k">def</span> <span class="nf">g_rsun_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots mass loss function for the Solar neighbourhood, ``p.Rsun``.</span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component. Can be ``&#39;d&#39;`` (thin disk), ``&#39;t&#39;`` (thick disk), or </span>
<span class="sd">            ``&#39;dt&#39;`` (thin + thick disk).</span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved (call ``a.T[&#39;inpplt&#39;]`` </span>
<span class="sd">            to display the folder name).</span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;mass loss&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">merged</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mf">0.6</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm{Mass \ fraction \ in \ stars \ and \ remnants}$&#39;</span><span class="p">,</span>
                      <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.91</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">!=</span><span class="s1">&#39;t&#39;</span><span class="p">:</span>
            <span class="n">gd0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;gd0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gd0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">gd0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span><span class="p">:</span>
                <span class="n">gt</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;gt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">gt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">gt</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;gt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">gt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">gt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;inpplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;g_R&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">),</span><span class="s1">&#39;_&#39;</span><span class="p">,</span>
                                                           <span class="n">mode_comp</span><span class="p">,</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">format_</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>         </div>


<div class="viewcode-block" id="Plotting.rhoz_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.rhoz_plt">[docs]</a>    <span class="k">def</span> <span class="nf">rhoz_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vertical density profiles of the Galactic components (thin and thick disk, </span>
<span class="sd">        molecular and atomic gas, DM and stellar halo) at some radius.</span>
<span class="sd">        </span>
<span class="sd">        :param R: Galactocentric distance, kpc.</span>
<span class="sd">        :type R: scalar</span>
<span class="sd">        :param normalized: Optional. If True, the profiles are normalized at each height  </span>
<span class="sd">            on the total density at this height. </span>
<span class="sd">        :type normalized: boolean</span>
<span class="sd">        :param cumulative: Optional. If True, the normalized cumulative mass profiles are plotted. </span>
<span class="sd">            At each height z, profiles are normalized on the total mass up to this z. </span>
<span class="sd">        :type cumulative: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved (call ``a.T[&#39;densplt&#39;]`` </span>
<span class="sd">            to display the folder name).</span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;normalized&#39;</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">R</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">:</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">inpcheck_radius</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">rhoz</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;rhoz&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">rhoztot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rhoz</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">legendloc</span> <span class="o">=</span> <span class="s1">&#39;best&#39;</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.8</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">ylabelname</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{\sum_</span><span class="si">{0}</span><span class="s1">^{|z|} M_i \ / \ \sum_</span><span class="si">{0}</span><span class="s1">^{|z|} M_</span><span class="si">{tot}</span><span class="s1">}$&#39;</span>
            <span class="n">rhoztot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rhoz</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rhoz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">rhoz</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="n">rhoztot</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                        <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.05</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;normalized&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                <span class="n">ylabelname</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{\rho_i(|z|) \ / \ \rho_</span><span class="si">{tot}</span><span class="s1">(|z|)}$&#39;</span>
                <span class="n">rhoztot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">rhoz</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rhoz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">rhoz</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">rhoztot</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                            <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.05</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ylabelname</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{\rho_i(|z|), \ M_\odot \ pc^{-3}}$&#39;</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">semilogy</span><span class="p">(</span><span class="n">rhoz</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">rhoz</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                                <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mf">1e-7</span><span class="p">,</span><span class="mf">1.05</span><span class="p">)</span>
                <span class="n">ylabelname</span><span class="p">,</span><span class="n">legendloc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">],</span><span class="mi">1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabelname</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathrm{R=}$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">R</span><span class="p">))</span><span class="o">+</span><span class="s1">&#39;$\mathrm{\ kpc}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]},</span><span class="n">loc</span><span class="o">=</span><span class="n">legendloc</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;normalized&#39;</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">])</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">rhoz_save</span><span class="p">(</span><span class="n">rhoz</span><span class="p">,</span><span class="n">R</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>
    
 
<div class="viewcode-block" id="Plotting.rhoz_monoage_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.rhoz_monoage_plt">[docs]</a>    <span class="k">def</span> <span class="nf">rhoz_monoage_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vertical density profiles of the mono-age subpopulations</span>
<span class="sd">        (plotting for :func:`jjmodel.analysis.rhoz_monoage`).</span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param R: Galactocentric distance, kpc.</span>
<span class="sd">        :type R: scalar</span>
<span class="sd">        :param ages: Set of age bins, Gyr. </span>
<span class="sd">        :type ages: array-like</span>
<span class="sd">        :param between: Optional. If True, the output quantity corresponds to the age intervals </span>
<span class="sd">            specified by parameter **ages**. Otherwise the individual single mono-age subpopulations </span>
<span class="sd">            are returned (i.e., age-bins of width ``tr``, model age resolution).</span>
<span class="sd">        :type between: boolean</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;dt&#39;``, **tab** must be organized as a list of tables for the thin and thick disk: </span>
<span class="sd">            [*table_d,table_t*]. If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [*table_d,table_t,table_sh*]. </span>
<span class="sd">        :type tab: astropy table or list[astropy table] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is the spatial number density of stars in :math:`\mathrm{number \ pc^{-3}}`,</span>
<span class="sd">             not matter density in :math:`\mathrm{M_\odot \ pc^{-3}}`. Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :type cbar_bins: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.rhoz_monoage_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;between&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;vertical mono-age profiles&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">R</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">:</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">inpcheck_radius</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ages</span> <span class="o">=</span> <span class="n">inpcheck_age</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">nage</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;between&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">nage</span> <span class="o">=</span> <span class="n">nage</span> <span class="o">-</span> <span class="mi">1</span>        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;between&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">rhoz</span> <span class="o">=</span> <span class="n">rhoz_monoage</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
        
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ages</span><span class="p">)),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ at \ R=}$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$\mathrm{\ kpc}$&#39;</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_log_</span><span class="p">(</span><span class="n">rhoz</span><span class="p">,[</span><span class="mf">1e-12</span><span class="p">,</span><span class="mf">1e-2</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">rhoz</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nage</span><span class="p">)],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>
                                       <span class="p">)</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ages</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">rhoz_monoage_save</span><span class="p">(</span><span class="n">rhoz</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">ages</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="Plotting.rhoz_monomet_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.rhoz_monomet_plt">[docs]</a>    <span class="k">def</span> <span class="nf">rhoz_monomet_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vertical density profiles of the mono-metallicity subpopulations</span>
<span class="sd">        (plotting for jjmodel.analysis.rhoz_monomet).</span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param R: Galactocentric distance, kpc.</span>
<span class="sd">        :type R: scalar</span>
<span class="sd">        :param mets: Set of metallicity bins, dex. </span>
<span class="sd">        :type mets: array-like</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;dt&#39;``, **tab** must be organized as a list of tables for the thin and thick disk: </span>
<span class="sd">            [*table_d,table_t*]. If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [*table_d,table_t,table_sh*]. </span>
<span class="sd">        :type tab: astropy table or list[astropy table] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is the spatial number density of stars in :math:`\mathrm{number \ pc^{-3}}`,</span>
<span class="sd">             not matter density in :math:`\mathrm{M_\odot \ pc^{-3}}`. Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :type cbar_bins: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.rhoz_monomet_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.    </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;vertical mono-metallicity profiles&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">R</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">:</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">inpcheck_radius</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">nage</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mets</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">rhoz</span> <span class="o">=</span> <span class="n">rhoz_monomet</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
        
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;feh&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">mets</span><span class="p">),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="n">mets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">mets</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">mets</span><span class="p">)),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;n&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
            <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ at \ R=}$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$\mathrm{\ kpc}$&#39;</span>
                               
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_log_</span><span class="p">(</span><span class="n">rhoz</span><span class="p">,[</span><span class="mf">1e-12</span><span class="p">,</span><span class="mf">1e-2</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>                     
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">rhoz</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nage</span><span class="p">)],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>
                                       <span class="p">)</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mets</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;fe&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">rhoz_monomet_save</span><span class="p">(</span><span class="n">rhoz</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">mets</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="Plotting.rz_map_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.rz_map_plt">[docs]</a>    <span class="k">def</span> <span class="nf">rz_map_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Density distribution in R and z Galactic coordinates. Can be matter or number density. </span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.rz_map`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total).</span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``. </span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]</span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param ages: Optional. Set of age bins, Gyr. </span>
<span class="sd">        :type ages: array-like</span>
<span class="sd">        :param mets: Optional. Set of metallicity bins.</span>
<span class="sd">        :type mets: array-like</span>
<span class="sd">        :param dz: Vertical resolution, pc. </span>
<span class="sd">        :type dz: scalar</span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.rz_map_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;dz&#39;</span><span class="p">,</span><span class="s1">&#39;ages&#39;</span><span class="p">,</span><span class="s1">&#39;mets&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;RZ-density map&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;dz&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inpcheck_dz</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dz&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;dens&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;ages&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{\ of \ \tau=}$&#39;</span> <span class="o">+</span> <span class="s1">&#39;$</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ages&#39;</span><span class="p">]))</span> <span class="o">+</span>\
                  <span class="sa">r</span><span class="s1">&#39;$\mathrm{ \ Gyr}$&#39;</span>                          
        <span class="k">if</span> <span class="s1">&#39;mets&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ of \ [Fe/H]=[}$&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span>\
                  <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{]}$&#39;</span>
        
        <span class="n">cbarlabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{log_</span><span class="si">{10}</span><span class="s1"> \ \rho \ [M_\odot \ pc^{-3}]}$&#39;</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">cbarlabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{log_</span><span class="si">{10}</span><span class="s1"> \ N \ [pc^{-3}]}$&#39;</span>
                   
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mets&#39;</span><span class="p">,</span><span class="s1">&#39;ages&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;dz&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">rz_grid</span> <span class="o">=</span> <span class="n">rz_map</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            
        <span class="n">ycmin</span><span class="p">,</span> <span class="n">ycmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_log_</span><span class="p">(</span><span class="n">rz_grid</span><span class="p">,[</span><span class="mf">1e-8</span><span class="p">,</span><span class="mf">1e1</span><span class="p">])</span>
        <span class="n">ycmin</span><span class="p">,</span> <span class="n">ycmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ycmin</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">ycmax</span><span class="p">)</span>
        <span class="n">ycbar</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ycmin</span><span class="p">,</span><span class="n">ycmax</span> <span class="o">+</span> <span class="mf">0.5</span><span class="p">,</span><span class="mf">0.5</span><span class="p">)</span>
        <span class="n">ycbar_lb</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ycbar</span><span class="p">)):</span>
            <span class="k">if</span> <span class="n">ycbar</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">%</span><span class="mi">1</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="n">ycbar_lb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;$</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ycbar</span><span class="p">[</span><span class="n">i</span><span class="p">])))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ycbar_lb</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
                
        <span class="n">rz_grid_flip</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">rz_grid</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">rz_grid_flip</span><span class="p">[</span><span class="n">rz_grid_flip</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">log10_rho</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">rz_grid_flip</span><span class="p">)</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mf">3.5</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">log10_rho</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span> 
                   <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="o">/</span><span class="mf">1e3</span><span class="p">],</span>
                   <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">ycmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">ycmax</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm{|z|, \ kpc}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ycbar</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">ycbar_lb</span><span class="p">)</span> 
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">cbarlabel</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">rz_map_save</span><span class="p">(</span><span class="n">rz_grid</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></div>
        
    
<div class="viewcode-block" id="Plotting.rz_map_quantity_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.rz_map_quantity_plt">[docs]</a>    <span class="k">def</span> <span class="nf">rz_map_quantity_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">quantity</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Distribution of some quantity Q in Rz-plane. Q can be W-velocity dispersion or </span>
<span class="sd">        stellar physical parameter from isochrones. Plotting for :func:`jjmodel.analysis.rz_map_quantity`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total).</span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param quantity: :param quantity: Name of the column in a stellar assemblies table to which </span>
<span class="sd">            the function has to be applied; for velocity dispersion use ``&#39;sigw&#39;``. </span>
<span class="sd">        :type quantity: str</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``. </span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str     </span>
<span class="sd">        :param ages: Optional. Set of age bins, Gyr. </span>
<span class="sd">        :type ages: array-like</span>
<span class="sd">        :param mets: Optional. Set of metallicity bins.</span>
<span class="sd">        :type mets: array-like</span>
<span class="sd">        :param dz: Vertical resolution, pc. </span>
<span class="sd">        :type dz: scalar</span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.rz_map_quantity_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;ages&#39;</span><span class="p">,</span><span class="s1">&#39;mets&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;dz&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;RZ-quantity map&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;dz&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">inpcheck_dz</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dz&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>        
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;dens&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;ages&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{\ of \ \tau=}$&#39;</span> <span class="o">+</span> <span class="s1">&#39;$</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ages&#39;</span><span class="p">]))</span> <span class="o">+</span>\
                  <span class="sa">r</span><span class="s1">&#39;$\mathrm{ \ Gyr}$&#39;</span>                          
        <span class="k">if</span> <span class="s1">&#39;mets&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ of \ [Fe/H]=[}$&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span>\
                  <span class="nb">str</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{]}$&#39;</span>
        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;dz&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;ages&#39;</span><span class="p">,</span><span class="s1">&#39;mets&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">rz_grid</span> <span class="o">=</span> <span class="n">rz_map_quantity</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">quantity</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
        <span class="n">mean_q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">rz_grid</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    
        <span class="k">if</span> <span class="n">quantity</span><span class="o">==</span><span class="s1">&#39;age&#39;</span><span class="p">:</span>
            <span class="n">ycbar</span><span class="p">,</span> <span class="n">ycbar_ticklabels</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">]</span>
            <span class="n">ycbar_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">]</span>
            <span class="n">ycmin</span><span class="p">,</span> <span class="n">ycmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tp</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">ycbar_label</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cbar_settings</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                <span class="n">dy1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cbar_settings</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">interval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">rz_grid</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">rz_grid</span><span class="p">)</span>
                <span class="n">interval_decimal_points</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%.0e</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">interval</span><span class="p">))</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">while</span> <span class="n">dy1</span> <span class="o">&gt;</span> <span class="n">interval</span> <span class="ow">or</span> <span class="n">interval</span><span class="o">/</span><span class="n">dy1</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                    <span class="n">dy1</span> <span class="o">=</span> <span class="n">dy1</span><span class="o">/</span><span class="mi">2</span>
                <span class="n">ss</span> <span class="o">=</span> <span class="s2">&quot;%.&quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">interval_decimal_points</span><span class="p">))</span><span class="o">+</span><span class="s2">&quot;e&quot;</span>
                <span class="n">dy1</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">ss</span> <span class="o">%</span> <span class="n">dy1</span><span class="p">)</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">dy1</span><span class="p">,</span><span class="n">interval_decimal_points</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">dy</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">dy</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">dy1</span><span class="p">,</span><span class="n">interval_decimal_points</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">while</span> <span class="n">interval</span><span class="o">/</span><span class="n">dy</span> <span class="o">&gt;</span> <span class="mi">6</span><span class="p">:</span>
                    <span class="n">dy</span> <span class="o">=</span> <span class="n">dy</span><span class="o">*</span><span class="mi">2</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">dy</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">rz_grid</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">rz_grid</span><span class="p">))</span><span class="o">/</span><span class="mi">4</span>
                <span class="n">interval_decimal_points</span> <span class="o">=</span> <span class="mi">2</span> 
            <span class="n">ycmin</span><span class="p">,</span> <span class="n">ycmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_1d_lin_</span><span class="p">(</span><span class="n">rz_grid</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cbar_settings</span><span class="p">[</span><span class="n">quantity</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">dy</span><span class="p">)</span>
            <span class="n">ybins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">ycmin</span><span class="p">,</span><span class="n">ycmax</span><span class="o">+</span><span class="n">dy</span><span class="p">,</span><span class="n">dy</span><span class="p">,</span><span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float</span><span class="p">)</span>   
            <span class="n">ybins</span> <span class="o">=</span> <span class="p">[</span><span class="nb">round</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">interval_decimal_points</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ybins</span><span class="p">]</span>
            <span class="n">test</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ybins</span><span class="p">)):</span>
                <span class="n">pv</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">ybins</span><span class="p">[</span><span class="n">k</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">pv</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">test</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">test</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
                <span class="n">ybins</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ybins</span><span class="p">]</span>
            <span class="n">ycbar</span><span class="p">,</span> <span class="n">ycbar_ticklabels</span> <span class="o">=</span> <span class="n">ybins</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;$</span><span class="si">{}</span><span class="s1">$&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ybins</span><span class="p">]</span> 
                
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span><span class="mf">3.5</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">mean_q</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span> 
                       <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="o">/</span><span class="mf">1e3</span><span class="p">],</span>
                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">ycmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">ycmax</span><span class="p">))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm{|z|, \ kpc}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">ycbar</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="n">ycbar_ticklabels</span><span class="p">)</span> 
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">ycbar_label</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">rz_map_quantity_save</span><span class="p">(</span><span class="n">rz_grid</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">quantity</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>


<div class="viewcode-block" id="Plotting.agez_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.agez_plt">[docs]</a>    <span class="k">def</span> <span class="nf">agez_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mean age as a function of height z and Galactocentric distance R.</span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.agez`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total).</span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``. </span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density in (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :type cbar_bins: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.agez_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;vertical age profiles&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">agezr</span><span class="p">,</span> <span class="n">agezr0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tp</span><span class="o">+</span><span class="mf">0.1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">agezr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">)],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                   
                                       <span class="p">)</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">agezt</span><span class="p">,</span> <span class="n">agezt0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">agezt0</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm{Thick \ disk}$&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">agezsh</span><span class="p">,</span> <span class="n">agezsh0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">agezsh0</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm</span><span class="si">{Halo}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">agezr0</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">agez_save</span><span class="p">((</span><span class="n">agezr</span><span class="p">,</span><span class="n">agezr0</span><span class="p">),</span><span class="n">mode_comp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>
    

<div class="viewcode-block" id="Plotting.agez_rsun_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.agez_rsun_plt">[docs]</a>    <span class="k">def</span> <span class="nf">agez_rsun_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mean age as a function of height z for the Solar neighbourhood, ``p.Rsun``.</span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.agez`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total).</span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table, parameter alternative to mode_pop. </span>
<span class="sd">            For **mode_pop** = ``tot``, *tab* is constructed as [*table_d,table_t,table_sh*] with tables for ``p.Rsun``. </span>
<span class="sd">        :type tab: astropy table or list[astropy table] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density in (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.agez_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;vertical age profiles&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
            
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="p">(</span><span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">]</span>
            <span class="n">agezr0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">agezr0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
            
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tp</span><span class="o">+</span><span class="mf">0.1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.91</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">agezr0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">agezt0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">agezdt0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                               <span class="n">tab</span><span class="o">=</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">agezt0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
                <span class="n">agezdt0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">agezt0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">agezdt0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">agezt0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">agezsh0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">ageztot0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;tot&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                                <span class="n">tab</span><span class="o">=</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">]])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">agezt0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
                <span class="n">agezsh0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
                <span class="n">ageztot0</span> <span class="o">=</span> <span class="n">agez</span><span class="p">(</span><span class="s1">&#39;tot&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">agezt0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">agezsh0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">ageztot0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
                
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">agez_save</span><span class="p">(</span><span class="n">agezr0</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>


<div class="viewcode-block" id="Plotting.ager_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.ager_plt">[docs]</a>    <span class="k">def</span> <span class="nf">ager_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Radial age profiles. Plotting for :func:`jjmodel.analysis.ager`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param zlim: Range of heights [*zmin,zmax*], pc. </span>
<span class="sd">        :type zlim: array-like </span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``. </span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :type cbar_bins: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.ager_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;radial age profiles&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">zlim</span> <span class="o">=</span> <span class="n">inpcheck_height</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>        
        
        <span class="n">nz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="o">/</span><span class="mf">1e3</span>
        
        <span class="n">age_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">))</span>
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nz</span><span class="p">):</span>
            <span class="n">age_r</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">ager</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="n">zlim</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">zlim</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>        
    
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">tp</span> <span class="o">+</span> <span class="mf">0.1</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>           
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
    
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">age_r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nz</span><span class="p">)],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                   
                                       <span class="p">)</span>
        <span class="n">dz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">zlim</span><span class="p">))</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">zlim</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">agert</span> <span class="o">=</span> <span class="n">ager</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,[</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">agert</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm{Thick \ disk}$&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">agersh</span> <span class="o">=</span> <span class="n">ager</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">,[</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">agersh</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;magenta&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm</span><span class="si">{Halo}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span>
                     <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]},</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">dz</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dz</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">dz</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;zkpc&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">ager_save</span><span class="p">(</span><span class="n">age_r</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> 
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>


<div class="viewcode-block" id="Plotting.metz_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.metz_plt">[docs]</a>    <span class="k">def</span> <span class="nf">metz_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; </span>
<span class="sd">        Mean metallicity as a function of height z and Galactocentric distance R.</span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.metz`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``. </span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :type cbar_bins: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.metz_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;metallicity profiles&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
               
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">fehzr</span><span class="p">,</span> <span class="n">fehzr0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>     
            
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_1d_lin_</span><span class="p">(</span><span class="n">fehzr</span><span class="p">,[</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mf">0.2</span><span class="p">)</span>

        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;fe&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">fehzr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">)],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                   
                                       <span class="p">)</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">fehzt</span><span class="p">,</span> <span class="n">fehzt0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">fehzt0</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm{Thick \ disk}$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">fehzr0</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">metz_save</span><span class="p">((</span><span class="n">fehzr</span><span class="p">,</span><span class="n">fehzr0</span><span class="p">),</span><span class="n">mode_comp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>
    
    
<div class="viewcode-block" id="Plotting.metz_rsun_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.metz_rsun_plt">[docs]</a>    <span class="k">def</span> <span class="nf">metz_rsun_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;        </span>
<span class="sd">        Mean metallicity as a function of height z for the Solar neighbourhood, p.Rsun.</span>
<span class="sd">        Plotting for jjmodel.analysis.metz. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp:Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            For **mode_comp** = ``tot``,  </span>
<span class="sd">            *tab* is constructed as [*table_d,table_t,table_sh*] with tables for ``p.Rsun``. </span>
<span class="sd">        :type tab: astropy table or list[astropy table] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.metz_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;metallicity profiles&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
               
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">):</span>
            <span class="k">del</span> <span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">]</span>
            <span class="n">fehzr0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">fehzr0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>     
            
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;fe&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.13</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.91</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">fehzr0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">])</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_1d_lin_</span><span class="p">(</span><span class="n">fehzr0</span><span class="p">,[</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mf">0.2</span><span class="p">)</span>
                                                    
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">fehzt0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">fehzdt0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fehzt0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
                <span class="n">fehzdt0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">fehzt0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">fehzdt0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;dt&#39;</span><span class="p">])</span>
            <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_1d_lin_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">fehzr0</span><span class="p">,</span><span class="n">fehzt0</span><span class="p">,</span><span class="n">fehzdt0</span><span class="p">),</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
                                                    <span class="p">[</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">fehzt0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="n">fehzsh0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                <span class="n">fehztot0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;tot&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fehzt0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
                <span class="n">fehzsh0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
                <span class="n">fehztot0</span> <span class="o">=</span> <span class="n">metz</span><span class="p">(</span><span class="s1">&#39;tot&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">fehzt0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">fehzsh0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">fehztot0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">])</span>
            <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_1d_lin_</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">((</span><span class="n">fehzr0</span><span class="p">,</span><span class="n">fehzt0</span><span class="p">,</span><span class="n">fehzsh0</span><span class="p">,</span><span class="n">fehztot0</span><span class="p">),</span><span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
                                                    <span class="p">[</span><span class="o">-</span><span class="mf">0.6</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>      
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">metz_save</span><span class="p">(</span><span class="n">fehzr0</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>

    
<div class="viewcode-block" id="Plotting.metr_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.metr_plt">[docs]</a>    <span class="k">def</span> <span class="nf">metr_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;        </span>
<span class="sd">        Radial metallicity profiles. Plotting for :func:`jjmodel.analysis.metr`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component. Can be ``&#39;d&#39;`` (thin disk), ``&#39;dt&#39;`` (thin + thick disk), </span>
<span class="sd">            or ``&#39;tot&#39;`` (total: thin + thick disk + stellar halo). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param zlim: Range of heights [*zmin,zmax*], pc. </span>
<span class="sd">        :type zlim: array-like </span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``. </span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :type cbar_bins: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.metr_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;metallicity profiles&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">zlim</span> <span class="o">=</span> <span class="n">inpcheck_height</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="o">/</span><span class="mf">1e3</span>
        
        <span class="n">nz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">fehr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">))</span>
              
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nz</span><span class="p">):</span>
            <span class="n">fehr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">metr</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="n">zlim</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">zlim</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>        
    
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;fe&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">fehr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nz</span><span class="p">)],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                  
                                       <span class="p">)</span>
        <span class="n">dz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">zlim</span><span class="p">))</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="n">dz</span><span class="o">/</span><span class="mi">2</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">]</span>
                <span class="n">fehrt</span> <span class="o">=</span> <span class="n">metr</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,[</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                             <span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">fehrt</span> <span class="o">=</span> <span class="n">metr</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,[</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">fehrt</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm{Thick \ disk}$&#39;</span><span class="p">)</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_lin_</span><span class="p">(</span><span class="n">fehr</span><span class="p">,[</span><span class="o">-</span><span class="mf">1.4</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="mf">0.2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>      
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span>
                     <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]},</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">dz</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dz</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">dz</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;zkpc&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">metr_save</span><span class="p">(</span><span class="n">fehr</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> 
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>

  
<div class="viewcode-block" id="Plotting.rhor_monoage_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.rhor_monoage_plt">[docs]</a>    <span class="k">def</span> <span class="nf">rhor_monoage_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Radial densiy profiles of the mono-age subpopulations. </span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.rhor_monoage`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param zlim: Range of heights [*zmin,zmax*], pc. </span>
<span class="sd">        :type zlim: array-like </span>
<span class="sd">        :param ages: Set of age bins, Gyr. </span>
<span class="sd">        :type ages: array-like</span>
<span class="sd">        :param sigma: Optional. If True, the result is surface density in :math:`\mathrm{M_\odot \ pc^{-2}}`, </span>
<span class="sd">            otherwise the midplane mass density in :math:`\mathrm{M_\odot \ pc^{-3}}` is calculated. </span>
<span class="sd">            In combination with **number** = True, returns the *number* surface density in :math:`\mathrm{number \ pc^{-2}}`.</span>
<span class="sd">        :type sigma: boolean</span>
<span class="sd">        :param between: Optional. If True, the output quantity corresponds to the age intervals </span>
<span class="sd">            specified by parameter **ages**. Otherwise the individual single mono-age subpopulations </span>
<span class="sd">            are returned (i.e., age-bins of width ``tr``, model age resolution).</span>
<span class="sd">        :type between: boolean</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``. </span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is the spatial number density of stars in :math:`\mathrm{number \ pc^{-3}}`,</span>
<span class="sd">             not matter density in :math:`\mathrm{M_\odot \ pc^{-3}}`. Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :type cbar_bins: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.rhor_monoage_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span><span class="s1">&#39;between&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;radial mono-age profiles&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ages</span> <span class="o">=</span> <span class="n">inpcheck_age</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">zlim</span> <span class="o">=</span> <span class="n">inpcheck_height</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ at \ |z|=[}$&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{] \ kpc}$&#39;</span>
        
        <span class="n">nage</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;between&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">nage</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span> 
            
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ages</span><span class="p">)),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                                       
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span><span class="s1">&#39;between&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">rhor</span> <span class="o">=</span> <span class="n">rhor_monoage</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
        
        <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                    <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;$\mathrm{N, \ pc^{-2}}$&#39;</span>                   
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                    <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;$\mathrm{N, \ pc^{-3}}$&#39;</span>
       
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">))</span>        
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_log_</span><span class="p">(</span><span class="n">rhor</span><span class="p">,[</span><span class="mf">1e-12</span><span class="p">,</span><span class="mf">1.05</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">rhor</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nage</span><span class="p">)],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>
                                       <span class="p">)</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ages</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span>
                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]},</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">rhor_monoage_save</span><span class="p">(</span><span class="n">rhor</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>


<div class="viewcode-block" id="Plotting.rhor_monomet_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.rhor_monomet_plt">[docs]</a>    <span class="k">def</span> <span class="nf">rhor_monomet_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Radial densiy profiles of the mono-metallicity subpopulations. </span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.rhor_monomet`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param zlim: Range of heights [*zmin,zmax*], pc. </span>
<span class="sd">        :type zlim: array-like </span>
<span class="sd">        :param mets: Set of metallicity bins, dex. </span>
<span class="sd">        :type mets: array-like</span>
<span class="sd">        :param sigma: Optional. If True, the result is surface density in :math:`\mathrm{M_\odot \ pc^{-2}}`, </span>
<span class="sd">            otherwise the midplane mass density in :math:`\mathrm{M_\odot \ pc^{-3}}` is calculated. </span>
<span class="sd">            In combination with **number** = True, returns the *number* surface density in :math:`\mathrm{number \ pc^{-2}}`.</span>
<span class="sd">        :type sigma: boolean</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``. </span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is the spatial number density of stars in :math:`\mathrm{number \ pc^{-3}}`,</span>
<span class="sd">             not matter density in :math:`\mathrm{M_\odot \ pc^{-3}}`. Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :type cbar_bins: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.rhor_monomet_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;sigma&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;radial mono-metallicity profiles&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>   
        <span class="n">zlim</span> <span class="o">=</span> <span class="n">inpcheck_height</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ at \ |z|=[}$&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{] \ kpc}$&#39;</span>

        <span class="n">nmet</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">mets</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>     
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;feh&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">mets</span><span class="p">),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">mets</span><span class="p">),</span><span class="mi">2</span><span class="p">),</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">mets</span><span class="p">),</span><span class="mi">2</span><span class="p">),</span>
                                       <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">mets</span><span class="p">)),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                    
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">rhomet</span> <span class="o">=</span> <span class="n">rhor_monomet</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
        
        <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;rho&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;sigma&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                <span class="n">ylabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigma&#39;</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                    <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;$\mathrm{N, \ pc^{-2}}$&#39;</span>                   
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                    <span class="n">ylabel</span> <span class="o">=</span> <span class="s1">&#39;$\mathrm{N, \ pc^{-3}}$&#39;</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_log_</span><span class="p">(</span><span class="n">rhomet</span><span class="p">,[</span><span class="mf">1e-12</span><span class="p">,</span><span class="mf">1.05</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">rhomet</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmet</span><span class="p">)],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                   
                                       <span class="p">)</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mets</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span>
                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]},</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;fe&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">rhor_monomet_save</span><span class="p">(</span><span class="n">rhomet</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mets</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>


<div class="viewcode-block" id="Plotting.agehist_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.agehist_plt">[docs]</a>    <span class="k">def</span> <span class="nf">agehist_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Age distribution (normalized on area) as a function of height and Galactocentric distance. </span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.agehist`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param zlim: Range of heights [*zmin,zmax*], pc. </span>
<span class="sd">        :type zlim: array-like </span>
<span class="sd">        :param cumulative: Optional. If True, the normalized cumulative age distributions will be plotted. </span>
<span class="sd">        :type cumulative: boolean</span>
<span class="sd">        :param sigma_gauss: Optional. Standard deviation of the Gaussian kernel used to smooth</span>
<span class="sd">            the age distributions, Gyr.</span>
<span class="sd">        :type sigma_gauss: scalar</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``. </span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set.  </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :type cbar_bins: boolean</span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.agehist_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;sigma_gauss&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">zlim</span> <span class="o">=</span> <span class="n">inpcheck_height</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;age distributions&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;$\mathrm{at \ |z|=[}$&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="o">+</span>\
              <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{] \ kpc}$&#39;</span>

        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;sigma_gauss&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">ages</span><span class="p">,</span> <span class="n">ages0</span> <span class="o">=</span> <span class="n">agehist</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">ages</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ages</span><span class="p">]</span>
            <span class="n">ages</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ages</span><span class="p">]</span>
            <span class="n">ages0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ages0</span><span class="p">)</span>
            <span class="n">ages0</span> <span class="o">=</span> <span class="n">ages0</span><span class="o">/</span><span class="n">ages0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.01</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">ages</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">ages</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mf">0.001</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{f \, (\tau)}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(((</span><span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">)</span> <span class="ow">and</span> 
            <span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;gdw&#39;</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;kdw&#39;</span> <span class="ow">or</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]</span><span class="o">==</span><span class="s1">&#39;rc&#39;</span><span class="p">)</span> <span class="ow">and</span> 
            <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">))</span> <span class="ow">or</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="n">ln</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="n">ln</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">])</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">ages</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R_array</span><span class="p">],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                   
                                       <span class="p">)</span>                                      
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">ages0</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;save_format&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span> 
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;save_format&#39;</span><span class="p">]</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">agehist_save</span><span class="p">((</span><span class="n">ages</span><span class="p">,</span><span class="n">ages0</span><span class="p">),</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></div>


<div class="viewcode-block" id="Plotting.agehist_rsun_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.agehist_rsun_plt">[docs]</a>    <span class="k">def</span> <span class="nf">agehist_rsun_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Age distribution (normalized on area) as a function of height for the Solar neighbourhood, ``p.Rsun``.</span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.agehist`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param zlim: Range of heights [*zmin,zmax*], pc. Or set of z-bin edges, pc. </span>
<span class="sd">        :type zlim: array-like </span>
<span class="sd">        :param cumulative: Optional. If True, the normalized cumulative age distributions will be plotted. </span>
<span class="sd">        :type cumulative: boolean</span>
<span class="sd">        :param sigma_gauss: Optional. Standard deviation of the Gaussian kernel used to smooth</span>
<span class="sd">            the age distributions, Gyr.</span>
<span class="sd">        :type sigma_gauss: scalar</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [*table_d,table_t,table_sh*] with tables for ``p.Rsun``.  </span>
<span class="sd">        :type tab: astropy table or list[astropy table] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set.  </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. Needed only when **zlim** is not a single </span>
<span class="sd">            slice, but a set of z-bins. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.agehist_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;sigma_gauss&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">zlim</span> <span class="o">=</span> <span class="n">inpcheck_height</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;age distributions&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">+</span><span class="s1">&#39;$\mathrm{at \ |z|=[}$&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span>\
              <span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{] \ kpc}$&#39;</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">nz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="o">/</span><span class="mf">1e3</span>
        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;sigma_gauss&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span> 
            <span class="n">ages0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nz</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">jd</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nz</span><span class="p">):</span>
                <span class="n">ages0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">agehist</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="n">zlim</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">zlim</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                                   <span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ages0</span><span class="p">,</span> <span class="n">sum_rho0</span> <span class="o">=</span> <span class="n">agehist</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">]</span>
                    <span class="n">agesd0</span><span class="p">,</span> <span class="n">sum_rhod0</span> <span class="o">=</span> <span class="n">agehist</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                                                <span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">agest0</span><span class="p">,</span> <span class="n">sum_rhot0</span> <span class="o">=</span> <span class="n">agehist</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                                                <span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">agesd0</span><span class="p">,</span> <span class="n">sum_rhod0</span> <span class="o">=</span> <span class="n">agehist</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>                                                
                    <span class="n">agest0</span><span class="p">,</span> <span class="n">sum_rhot0</span> <span class="o">=</span> <span class="n">agehist</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
                                                
                <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                        <span class="n">agessh0</span><span class="p">,</span> <span class="n">sum_rhosh0</span> <span class="o">=</span> <span class="n">agehist</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                                                      <span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">agessh0</span><span class="p">,</span> <span class="n">sum_rhosh0</span> <span class="o">=</span> <span class="n">agehist</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                                                      <span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span> 
            <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                <span class="n">ages0</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ages0</span><span class="p">]</span>
                <span class="n">ages0</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">ages0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                <span class="n">ages0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">ages0</span><span class="o">*</span><span class="n">sum_rho0</span><span class="p">)</span>
                <span class="n">agemax</span> <span class="o">=</span> <span class="n">ages0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                    <span class="n">agesd0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">agesd0</span><span class="o">*</span><span class="n">sum_rhod0</span><span class="p">)</span>
                    <span class="n">agest0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">agest0</span><span class="o">*</span><span class="n">sum_rhot0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                        <span class="n">agessh0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">agessh0</span><span class="o">*</span><span class="n">sum_rhosh0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ages0</span> <span class="o">=</span> <span class="n">ages0</span><span class="o">*</span><span class="n">sum_rho0</span>
                <span class="n">agemax</span> <span class="o">=</span> <span class="n">sum_rho0</span>
                <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                    <span class="n">agesd0</span> <span class="o">=</span> <span class="n">agesd0</span><span class="o">*</span><span class="n">sum_rhod0</span>
                    <span class="n">agest0</span> <span class="o">=</span> <span class="n">agest0</span><span class="o">*</span><span class="n">sum_rhot0</span>
                    <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                        <span class="n">agessh0</span> <span class="o">=</span> <span class="n">agessh0</span><span class="o">*</span><span class="n">sum_rhosh0</span>
            <span class="n">ages0</span> <span class="o">=</span> <span class="n">ages0</span><span class="o">/</span><span class="n">agemax</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                <span class="n">agesd0</span> <span class="o">=</span> <span class="n">agesd0</span><span class="o">/</span><span class="n">agemax</span>
                <span class="n">agest0</span> <span class="o">=</span> <span class="n">agest0</span><span class="o">/</span><span class="n">agemax</span>  
                <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                    <span class="n">agessh0</span> <span class="o">=</span> <span class="n">agessh0</span><span class="o">/</span><span class="n">agemax</span>               
                
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.01</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">ages0</span><span class="p">),</span><span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="mi">1000</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">ages0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mf">0.001</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{f \, (\tau)}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="c1"># if ((&#39;mode_pop&#39; in kwargs) and </span>
        <span class="c1">#     (kwargs[&#39;mode_pop&#39;]==&#39;gdw&#39; or kwargs[&#39;mode_pop&#39;]==&#39;kdw&#39; or kwargs[&#39;mode_pop&#39;]==&#39;rc&#39;) and </span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.55</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="n">ln</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.3</span><span class="p">,</span><span class="mf">0.9</span><span class="p">,</span><span class="n">ln</span><span class="p">,</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span> 
            <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
            <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">ages0</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nz</span><span class="p">)],</span>
                                           <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>
                                           <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                   
                                           <span class="p">)</span>   
            <span class="n">dz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">zlim</span><span class="p">))</span>
            <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="n">dz</span><span class="o">/</span><span class="mi">2</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span>                                   
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">dz</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dz</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">dz</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;zkpc&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.91</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">agesd0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">agest0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">agessh0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">])</span>  
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">ages0</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="n">mode_comp</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="n">mode_comp</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">t</span><span class="p">,</span><span class="n">ages0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="n">mode_comp</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="n">mode_comp</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
                        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;save_format&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;save_format&#39;</span><span class="p">]</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">agehist_save</span><span class="p">(</span><span class="n">ages0</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></div>


<div class="viewcode-block" id="Plotting.methist_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.methist_plt">[docs]</a>    <span class="k">def</span> <span class="nf">methist_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;     </span>
<span class="sd">        Metallicity distribution (normalized on area) as a function of height and Galactocentric distance. </span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.methist`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param zlim: Range of heights [*zmin,zmax*], pc. </span>
<span class="sd">        :type zlim: array-like </span>
<span class="sd">        :param metbins: Optional. Set of metallicity bins. If not given, the grid is -1.1,...,0.8 dex </span>
<span class="sd">            with 0.05 dex step. </span>
<span class="sd">        :type metbins: array-like</span>
<span class="sd">        :param cumulative: Optional. If True, the normalized cumulative metallicity distributions will be plotted. </span>
<span class="sd">        :type cumulative: boolean</span>
<span class="sd">        :param sigma_gauss: Optional. Standard deviation of the Gaussian kernel used to smooth</span>
<span class="sd">            the metallicity distributions, dex.</span>
<span class="sd">        :type sigma_gauss: scalar</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``. </span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set.  </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.methist_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;sigma_gauss&#39;</span><span class="p">,</span><span class="s1">&#39;metbins&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span>
                        <span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;metallicity distributions&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">zlim</span> <span class="o">=</span> <span class="n">inpcheck_height</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ at \ |z|=[}$&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{] \ kpc}$&#39;</span>

        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> 

        <span class="n">mmin</span><span class="p">,</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">dmet</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.05</span>
        <span class="n">metbins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mmin</span><span class="p">,</span><span class="n">mmax</span><span class="o">+</span><span class="n">dmet</span><span class="p">,</span><span class="n">dmet</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;metbins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">metbins</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;metbins&#39;</span><span class="p">]</span>
            <span class="n">mmin</span><span class="p">,</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">dmet</span> <span class="o">=</span> <span class="n">metbins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">metbins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">metbins</span><span class="p">))</span>           
        <span class="n">metbinsc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">metbins</span><span class="p">,</span><span class="n">dmet</span><span class="o">/</span><span class="mi">2</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;sigma_gauss&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;metbins&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">metdist</span><span class="p">,</span> <span class="n">metdist0</span> <span class="o">=</span> <span class="n">methist</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">metdist</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metdist</span><span class="p">]</span>
            <span class="n">metdist</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metdist</span><span class="p">]</span>
            <span class="n">metdist0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">metdist0</span><span class="p">)</span>
            <span class="n">metdist0</span> <span class="o">=</span> <span class="n">metdist0</span><span class="o">/</span><span class="n">metdist0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">mmin</span><span class="p">,</span><span class="n">mmax</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.01</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">metdist</span><span class="p">)</span><span class="o">//</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.2</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;fe&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{f \, ([Fe/H])}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">metbinsc</span><span class="p">,</span><span class="n">metdist</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R_array</span><span class="p">],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                   
                                       <span class="p">)</span>                                      
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metbinsc</span><span class="p">,</span><span class="n">metdist0</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">methist_save</span><span class="p">((</span><span class="n">metdist</span><span class="p">,</span><span class="n">metdist0</span><span class="p">,</span><span class="n">metbinsc</span><span class="p">),</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></div>


<div class="viewcode-block" id="Plotting.methist_rsun_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.methist_rsun_plt">[docs]</a>    <span class="k">def</span> <span class="nf">methist_rsun_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Metallicity distribution (normalized on area) as a function of height </span>
<span class="sd">        for the Solar neighbourhood, p. Rsun. Plotting for jjmodel.analysis.methist. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param zlim: Range of heights [*zmin,zmax*], pc. Or set of z-bin edges, pc. </span>
<span class="sd">        :type zlim: array-like </span>
<span class="sd">        :param metbins: Optional. Set of metallicity bins. If not given, the grid is -1.1,...,0.8 dex </span>
<span class="sd">            with 0.05 dex step. </span>
<span class="sd">        :type metbins: array-like</span>
<span class="sd">        :param cumulative: Optional. If True, the normalized cumulative age distributions will be plotted. </span>
<span class="sd">        :type cumulative: boolean</span>
<span class="sd">        :param sigma_gauss: Optional. Standard deviation of the Gaussian kernel used to smooth</span>
<span class="sd">            the metallicity distributions, dex.</span>
<span class="sd">        :type sigma_gauss: scalar</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [*table_d,table_t,table_sh*] with tables for ``p.Rsun``.  </span>
<span class="sd">        :type tab: astropy table or list[astropy table] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set.  </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. Needed only when **zlim** is not a single </span>
<span class="sd">            slice, but a set of z-bins. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.methist_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;sigma_gauss&#39;</span><span class="p">,</span><span class="s1">&#39;metbins&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span>
                        <span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;metallicity distributions&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">zlim</span> <span class="o">=</span> <span class="n">inpcheck_height</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ at \ |z|=[}$&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{] \ kpc}$&#39;</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">nz</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
            <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">zlim</span><span class="p">)),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">mmin</span><span class="p">,</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">dmet</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.05</span>
        <span class="n">metbins</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">mmin</span><span class="p">,</span><span class="n">mmax</span><span class="o">+</span><span class="n">dmet</span><span class="p">,</span><span class="n">dmet</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;metbins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">metbins</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;metbins&#39;</span><span class="p">]</span>
            <span class="n">mmin</span><span class="p">,</span> <span class="n">mmax</span><span class="p">,</span> <span class="n">dmet</span> <span class="o">=</span> <span class="n">metbins</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">metbins</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">metbins</span><span class="p">))</span>           
        <span class="n">metbinsc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">metbins</span><span class="p">,</span><span class="n">dmet</span><span class="o">/</span><span class="mi">2</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;sigma_gauss&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;metbins&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span> 
            <span class="n">metdist0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">nz</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">metbinsc</span><span class="p">)))</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nz</span><span class="p">):</span>
                <span class="n">metdist0</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">methist</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="n">zlim</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">zlim</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                                      <span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">metdist0</span><span class="p">,</span> <span class="n">sum_rho0</span> <span class="o">=</span> <span class="n">methist</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">]</span>
                    <span class="n">metdistd0</span><span class="p">,</span> <span class="n">sum_rhod0</span> <span class="o">=</span> <span class="n">methist</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                                                   <span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
                    <span class="n">metdistt0</span><span class="p">,</span> <span class="n">sum_rhot0</span> <span class="o">=</span> <span class="n">methist</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                                                   <span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">metdistd0</span><span class="p">,</span> <span class="n">sum_rhod0</span> <span class="o">=</span> <span class="n">methist</span><span class="p">(</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
                    <span class="n">metdistt0</span><span class="p">,</span> <span class="n">sum_rhot0</span> <span class="o">=</span> <span class="n">methist</span><span class="p">(</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                    <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                        <span class="n">metdistsh0</span><span class="p">,</span> <span class="n">sum_rhosh0</span> <span class="o">=</span> <span class="n">methist</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                                                         <span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">tab</span><span class="o">=</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;tab&#39;</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">metdistsh0</span><span class="p">,</span> <span class="n">sum_rhosh0</span> <span class="o">=</span> <span class="n">methist</span><span class="p">(</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span>
                                                         <span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>        
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span> 
            <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                <span class="n">metdist0</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metdist0</span><span class="p">]</span>
                <span class="n">metdist0</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="o">/</span><span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metdist0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                <span class="n">metdist0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">metdist0</span><span class="o">*</span><span class="n">sum_rho0</span><span class="p">)</span>
                <span class="n">metmax</span> <span class="o">=</span> <span class="n">metdist0</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                    <span class="n">metdistd0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">metdistd0</span><span class="o">*</span><span class="n">sum_rhod0</span><span class="p">)</span>
                    <span class="n">metdistt0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">metdistt0</span><span class="o">*</span><span class="n">sum_rhot0</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                        <span class="n">metdistsh0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cumsum</span><span class="p">(</span><span class="n">metdistsh0</span><span class="o">*</span><span class="n">sum_rhosh0</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">metdist0</span> <span class="o">=</span> <span class="n">metdist0</span><span class="o">*</span><span class="n">sum_rho0</span>
                <span class="n">metmax</span> <span class="o">=</span> <span class="n">sum_rho0</span>
                <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                    <span class="n">metdistd0</span> <span class="o">=</span> <span class="n">metdistd0</span><span class="o">*</span><span class="n">sum_rhod0</span>
                    <span class="n">metdistt0</span> <span class="o">=</span> <span class="n">metdistt0</span><span class="o">*</span><span class="n">sum_rhot0</span>
                    <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                        <span class="n">metdistsh0</span> <span class="o">=</span> <span class="n">metdistsh0</span><span class="o">*</span><span class="n">sum_rhosh0</span>
            <span class="n">metdist0</span> <span class="o">=</span> <span class="n">metdist0</span><span class="o">/</span><span class="n">metmax</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                <span class="n">metdistd0</span> <span class="o">=</span> <span class="n">metdistd0</span><span class="o">/</span><span class="n">metmax</span>
                <span class="n">metdistt0</span> <span class="o">=</span> <span class="n">metdistt0</span><span class="o">/</span><span class="n">metmax</span>  
                <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                    <span class="n">metdistsh0</span> <span class="o">=</span> <span class="n">metdistsh0</span><span class="o">/</span><span class="n">metmax</span>          
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="n">mmin</span><span class="p">,</span><span class="n">mmax</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.01</span><span class="p">))</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">mmin</span><span class="p">,</span><span class="n">mmax</span><span class="p">],[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;grey&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="mf">0.1</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">metdist0</span><span class="p">)</span><span class="o">//</span><span class="mf">0.1</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.2</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;fe&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{f \, ([Fe/H])}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span> 
            <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
            <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">metbinsc</span><span class="p">,</span><span class="n">metdist0</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nz</span><span class="p">)],</span>
                                           <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>
                                           <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                   
                                           <span class="p">)</span>                                      
            <span class="n">dz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">zlim</span><span class="p">))</span>
            <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="n">dz</span><span class="o">/</span><span class="mi">2</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span> 
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,(</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dz</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="n">dz</span><span class="o">/</span><span class="mf">1e3</span><span class="p">))</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;zkpc&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.91</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metbinsc</span><span class="p">,</span><span class="n">metdistd0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metbinsc</span><span class="p">,</span><span class="n">metdistt0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metbinsc</span><span class="p">,</span><span class="n">metdistsh0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                            <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">])</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metbinsc</span><span class="p">,</span><span class="n">metdist0</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="n">mode_comp</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="n">mode_comp</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">metbinsc</span><span class="p">,</span><span class="n">metdist0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="n">mode_comp</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                        <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="n">mode_comp</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;cumulative&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper left&#39;</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;save_format&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;save_format&#39;</span><span class="p">]</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">methist_save</span><span class="p">((</span><span class="n">metdist0</span><span class="p">,</span><span class="n">metbinsc</span><span class="p">),</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></div>


<div class="viewcode-block" id="Plotting.h_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.h_plt">[docs]</a>    <span class="k">def</span> <span class="nf">h_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        MW thin-disk&#39;s scale height as a function of time (and age).</span>
<span class="sd">        </span>
<span class="sd">        :param cbar: Optional. Matplotlib colomap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory is ``a.T[&#39;heightplt&#39;]``. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">Hd</span><span class="p">,</span> <span class="n">Hd0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Hd&#39;</span><span class="p">,</span><span class="s1">&#39;Hd0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pkey</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">Hdp</span> <span class="o">=</span> <span class="p">[</span><span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Hdp&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">radius</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">radius</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">]</span>
            <span class="n">Hdp</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">Hdp</span><span class="p">]</span>
            <span class="n">npeak</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigp</span><span class="p">)</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">))</span>
        <span class="n">hmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Hd</span><span class="p">[</span><span class="mi">1</span><span class="p">:,])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pkey</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">hmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Hd</span><span class="p">[</span><span class="mi">1</span><span class="p">:,]),</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Hdp</span><span class="p">)])</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="nb">round</span><span class="p">(</span><span class="n">hmax</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Hd</span><span class="p">[</span><span class="mi">1</span><span class="p">:,])</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.075</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">])</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Hd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Hd</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R_array</span><span class="p">],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                   
                                       <span class="p">)</span>                                      
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Hd0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Hd0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pkey</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npeak</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">tpk</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">tpk</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">),</span>
                           <span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">Hdp</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                           <span class="n">zorder</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;heightplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;Htau_d.&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">format_</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>         </div>


<div class="viewcode-block" id="Plotting.h_rsun_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.h_rsun_plt">[docs]</a>    <span class="k">def</span> <span class="nf">h_rsun_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        MW thin-disk&#39;s scale height as a function of time (and age)</span>
<span class="sd">        for the Solar neighbourhood, at ``p.Rsun``.</span>
<span class="sd">        </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory is ``a.T[&#39;heightplt&#39;]``. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                
        <span class="n">Hd0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Hd0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pkey</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">Hdp</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Hdp0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">npeak</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigp</span><span class="p">)</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">))</span>
        <span class="n">hmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Hd0</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pkey</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">hmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Hd0</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Hdp</span><span class="p">)])</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="nb">round</span><span class="p">(</span><span class="n">hmax</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">100</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span> <span class="o">-</span> <span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Hd0</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">100</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Hd0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Hd0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pkey</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npeak</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">tpk</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">Hdp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm{Special \ subpopulations}$&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">tpk</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">Hdp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>                           
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.91</span><span class="p">)</span>
                
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;heightplt&#39;</span><span class="p">],</span>
                               <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;Htau_d_R&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">),</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">format_</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>         </div>


<div class="viewcode-block" id="Plotting.hr_monoage_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.hr_monoage_plt">[docs]</a>    <span class="k">def</span> <span class="nf">hr_monoage_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scale heights of the disk&#39;s mono-age subpopulations as a function of Galactocentric distance.</span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.hr_monoage`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param ages: Set of age bins, Gyr. </span>
<span class="sd">        :type ages: array-like</span>
<span class="sd">        :param between: Optional. If True, the output quantity corresponds to the age intervals </span>
<span class="sd">            specified by parameter **ages**. Otherwise the individual single mono-age subpopulations </span>
<span class="sd">            are returned (i.e., age-bins of width ``tr``, model age resolution).</span>
<span class="sd">        :type between: boolean</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``</span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.hr_monoage_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;between&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span><span class="s1">&#39;scale heights&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ages</span> <span class="o">=</span> <span class="n">inpcheck_age</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>

        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="n">ages</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">ages</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ages</span><span class="p">)),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">Heffd</span><span class="p">,</span> <span class="n">Ht</span><span class="p">,</span> <span class="n">Hsh</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Heffd&#39;</span><span class="p">,</span><span class="s1">&#39;Ht&#39;</span><span class="p">,</span><span class="s1">&#39;Hsh&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;between&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">hr_monoage</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_lin_</span><span class="p">(</span><span class="n">H</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">],</span><span class="mi">50</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;d&#39;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Heffd</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">ymax</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="mf">1.05</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Heffd</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Ht</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">ymax</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="mf">1.05</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Ht</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Hsh</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">ymax</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="mf">1.05</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Hsh</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">H</span><span class="p">[:,</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">H</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">tp</span><span class="p">)</span>
                                       <span class="p">)</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ages</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">Heffd</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm</span><span class="si">{Thin}</span><span class="s1">$&#39;</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;$\mathrm{disk \ half}$&#39;</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;$\mathrm</span><span class="si">{thickness}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">Ht</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                    <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm</span><span class="si">{Thick}</span><span class="s1">$&#39;</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;$\mathrm{disk \ scale \ height}$&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">Hsh</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">],</span>
                    <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm{Halo \ scale \ height}$&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">hr_monoage_save</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">ages</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span></div>
    
    
<div class="viewcode-block" id="Plotting.hr_monomet_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.hr_monomet_plt">[docs]</a>    <span class="k">def</span> <span class="nf">hr_monomet_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scale heights of the disk&#39;s mono-metallicity sub-populations as a function of Galactocentric distance.</span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.hr_monomet`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param mets: Set of metallicity bins. </span>
<span class="sd">        :type mets: array-like</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``</span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.hr_monomet_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;mono-metallicity scale heights&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
            
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;feh&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="n">mets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">mets</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">mets</span><span class="p">)),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">H</span> <span class="o">=</span> <span class="n">hr_monomet</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
        
        <span class="n">Heffd</span><span class="p">,</span> <span class="n">Ht</span><span class="p">,</span> <span class="n">Hsh</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Heffd&#39;</span><span class="p">,</span><span class="s1">&#39;Ht&#39;</span><span class="p">,</span><span class="s1">&#39;Hsh&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_lin_</span><span class="p">(</span><span class="n">H</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">],</span><span class="mi">50</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;d&#39;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Heffd</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">ymax</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="mf">1.05</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Heffd</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Ht</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">ymax</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="mf">1.05</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Ht</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span> <span class="ow">and</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Hsh</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">&gt;</span> <span class="n">ymax</span><span class="p">:</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="mf">1.05</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Hsh</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">H</span><span class="p">[:,</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mets</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                   
                                       <span class="p">)</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mets</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">Heffd</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm</span><span class="si">{Thin}</span><span class="s1">$&#39;</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;$\mathrm{disk \ half}$&#39;</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;$\mathrm</span><span class="si">{thickness}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">Ht</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                    <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm</span><span class="si">{Thick}</span><span class="s1">$&#39;</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="s1">&#39;$\mathrm{disk \ scale \ height}$&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">Hsh</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
                    <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm{Halo \ scale \ height}$&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;fe&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">hr_monomet_save</span><span class="p">(</span><span class="n">H</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">mets</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>


<div class="viewcode-block" id="Plotting.hr_gas_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.hr_gas_plt">[docs]</a>    <span class="k">def</span> <span class="nf">hr_gas_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Scale heights of molecular and atomic gas as functions of Galactocentric distance.</span>
<span class="sd">        </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory is ``a.T[&#39;inpplt&#39;]``. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">H2</span><span class="p">,</span> <span class="n">HI</span><span class="p">,</span> <span class="n">Hg1</span><span class="p">,</span> <span class="n">Hg2</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;H2&#39;</span><span class="p">,</span><span class="s1">&#39;HI&#39;</span><span class="p">,</span><span class="s1">&#39;Hg1&#39;</span><span class="p">,</span><span class="s1">&#39;Hg2&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">))</span>
        <span class="n">indr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">HI</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">)</span><span class="o">==</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">HI</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">)))[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ymax</span> <span class="o">=</span> <span class="mi">50</span><span class="o">*</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">HI</span><span class="p">[</span><span class="mi">1</span><span class="p">][:</span><span class="n">indr</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="o">+</span><span class="n">HI</span><span class="p">[</span><span class="mi">2</span><span class="p">][:</span><span class="n">indr</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span><span class="o">/</span><span class="mi">50</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">50</span> 
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;h&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">H2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">H2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">H2</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm{H_2 \ from \ Nakanishi \ and \ Sofue \ (2016)}$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">errorbar</span><span class="p">(</span><span class="n">HI</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">HI</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">yerr</span><span class="o">=</span><span class="n">HI</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                    <span class="n">color</span><span class="o">=</span><span class="s1">&#39;darkgreen&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm{HI \ from \ Nakanishi \ and \ Sofue \ (2016)}$&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Hg1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Hg1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;g1&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;g1&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Hg2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Hg2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;g2&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;g2&#39;</span><span class="p">])</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;inpplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;HR_g.&#39;</span><span class="p">,</span><span class="n">format_</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> 
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>
    
    
<div class="viewcode-block" id="Plotting.avr_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.avr_plt">[docs]</a>    <span class="k">def</span> <span class="nf">avr_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots age - W-velocity dispersion relation (AVR).</span>
<span class="sd">        </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If true, the figure will be saved. </span>
<span class="sd">            The output directory is ``a.T[&#39;kinplt&#39;]``. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">AVRd</span><span class="p">,</span> <span class="n">AVRd0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;AVR&#39;</span><span class="p">,</span><span class="s1">&#39;AVR0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pkey</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">Hdp</span> <span class="o">=</span> <span class="p">[</span><span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Hdp&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">radius</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">radius</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">]</span>
            <span class="n">sigp</span> <span class="o">=</span> <span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">Hdp</span><span class="p">]</span>
            <span class="n">npeak</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigp</span><span class="p">)</span>
            
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">)</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_lin_</span><span class="p">(</span><span class="n">AVRd</span><span class="p">[</span><span class="mi">1</span><span class="p">:,],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pkey</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">ymax</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">sigp</span><span class="p">):</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">sigp</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigw&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">AVRd</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">AVRd</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R_array</span><span class="p">],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                  
                                       <span class="p">)</span>                                      
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AVRd0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">AVRd0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pkey</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npeak</span><span class="p">):</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">tpk</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">tpk</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">),</span>
                            <span class="p">[</span><span class="n">table</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">sigp</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">cmap</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
                            <span class="n">zorder</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;kinplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;AVR.&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">format_</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> 
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>         </div>


<div class="viewcode-block" id="Plotting.avr_rsun_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.avr_rsun_plt">[docs]</a>    <span class="k">def</span> <span class="nf">avr_rsun_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots age - W-velocity dispersion relation (AVR) </span>
<span class="sd">        for the Solar neighbourhood, at ``p.Rsun``.</span>
<span class="sd">        </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory is ``a.T[&#39;kinplt&#39;]``. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                
        <span class="n">AVRd0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;AVR0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">)</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_1d_lin_</span><span class="p">(</span><span class="n">AVRd0</span><span class="p">[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pkey</span><span class="o">==</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">ymax</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigp</span><span class="p">):</span>
            <span class="n">ymax</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigp</span><span class="p">)</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">10</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigw&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">axx</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">twiny</span><span class="p">()</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">][::</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">axx</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">AVRd0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">AVRd0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">pkey</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigp</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">i</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">tpk</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">,</span>
                               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm{Special \ subpopulations}$&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">tpk</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigp</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="n">s</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>        
            <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.91</span><span class="p">)</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;kinplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;AVR_R&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">),</span>
                                                           <span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">format_</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> 
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>         </div>

    
<div class="viewcode-block" id="Plotting.sigwr_thick_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.sigwr_thick_plt">[docs]</a>    <span class="k">def</span> <span class="nf">sigwr_thick_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Thick-disk W-velocity dispersion as a function of Galactocentric distance.</span>
<span class="sd">        </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory is ``a.T[&#39;kinplt&#39;]``. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                
        <span class="n">Sigt</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Sigt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="o">*</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">/</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="mi">10</span><span class="p">))</span>                 
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigw&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;kinplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;SigWR_t.&#39;</span><span class="p">,</span><span class="n">format_</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> 

        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>
    
    
<div class="viewcode-block" id="Plotting.sigwz_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.sigwz_plt">[docs]</a>    <span class="k">def</span> <span class="nf">sigwz_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        W-velocity dispersion as a function of height z and Galactocentric distance. </span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.sigwz`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``. </span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colomap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.sigwz_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;W-velocity dispersion&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">sigwzr</span><span class="p">,</span> <span class="n">sigwzr0</span> <span class="o">=</span> <span class="n">sigwz</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_lin_</span><span class="p">(</span><span class="n">sigwzr</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigw&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">sigwzr</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R_array</span><span class="p">],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                  
                                       <span class="p">)</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">sigwzr0</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span>
                <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">sigwz_save</span><span class="p">((</span><span class="n">sigwzr</span><span class="p">,</span><span class="n">sigwzr0</span><span class="p">),</span><span class="n">mode_comp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>


<div class="viewcode-block" id="Plotting.sigwz_rsun_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.sigwz_rsun_plt">[docs]</a>    <span class="k">def</span> <span class="nf">sigwz_rsun_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        W-velocity dispersion as a function of height z for the Solar neighbourhood, at ``p.Rsun``. </span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.sigwz`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [*table_d,table_t,table_sh*] with tables for ``p.Rsun``. </span>
<span class="sd">        :type tab: astropy table or list[astropy table] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.sigwz_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;W-velocity dispersion&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">sigwzr0</span> <span class="o">=</span> <span class="n">sigwz</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_1d_lin_</span><span class="p">(</span><span class="n">sigwzr0</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigw&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.91</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">z</span><span class="p">,</span><span class="n">sigwzr0</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="n">mode_comp</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
                        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">sigwz_save</span><span class="p">(</span><span class="n">sigwzr0</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>


<div class="viewcode-block" id="Plotting.sigwr_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.sigwr_plt">[docs]</a>    <span class="k">def</span> <span class="nf">sigwr_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        W-velocity dispersion as a function of Galactocentric distance.</span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.sigwr`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param zlim: Range of heights [*zmin,zmax*], pc. Or set of z-bin edges, pc. </span>
<span class="sd">        :type zlim: array-like </span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``</span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not by matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.sigwr_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;W-velocity dispersion&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
            
        <span class="n">nz</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span>                        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">nz</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="n">nz</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">zlim</span><span class="p">))</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">            sigw_r = np.zeros((nz-1,self.a.Rbins))</span>
<span class="sd">            for i in range(nz-1):</span>
<span class="sd">                sigw_r[i] = sigwr(mode_comp,[zlim[i],zlim[i+1]],self.p,self.a,**kwargs_calc)</span>
<span class="sd">            ymin, ymax = self._dynamic_ylim_log_(sigw_r,[1,120])</span>
<span class="sd">            &#39;&#39;&#39;</span>
        <span class="n">sigw_r</span> <span class="o">=</span> <span class="n">sigwr</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_1d_lin_</span><span class="p">(</span><span class="n">sigw_r</span><span class="p">,[</span><span class="mi">5</span><span class="p">,</span><span class="mi">120</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
                             
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">))</span>            
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">Sigt</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Sigt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ymax</span> <span class="o">&lt;</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">//</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">5</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ymax</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigsh</span><span class="p">):</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigsh</span><span class="o">//</span><span class="mi">5</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>           
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigw&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
                 
        <span class="k">if</span> <span class="n">nz</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
            <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">sigw_r</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nz</span><span class="o">-</span><span class="mi">1</span><span class="p">)],</span>
                                           <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                           <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                       
                                           <span class="p">)</span>
            <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">zlim</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">/</span><span class="mf">2e3</span><span class="p">))</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="o">+</span><span class="mf">0.2</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="mf">0.2</span><span class="p">))</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;zkpc&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span> 
            <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="o">+</span><span class="s1">&#39;$\mathrm{ \ at \ |z|=[}$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span>\
                         <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$\mathrm{] \ kpc}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>                                
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">sigw_r</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="n">mode_comp</span><span class="p">])</span>  
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,[</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigsh</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span>
                     <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>      
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">sigwr_save</span><span class="p">(</span><span class="n">sigw_r</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> 
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>
    

<div class="viewcode-block" id="Plotting.sigwr_monoage_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.sigwr_monoage_plt">[docs]</a>    <span class="k">def</span> <span class="nf">sigwr_monoage_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        W-velocity dispersion of mono-age sub-populations as a function of Galactocentric distance.</span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.sigwr_monoage`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp:  Galactic component, can be ``&#39;d&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param zlim: Range of heights [*zmin,zmax*], pc. Or set of z-bin edges, pc. </span>
<span class="sd">        :type zlim: array-like </span>
<span class="sd">        :param ages: Set of age bins, Gyr. </span>
<span class="sd">        :type ages: array-like</span>
<span class="sd">        :param between: Optional. If True, the output quantity corresponds to the age intervals </span>
<span class="sd">            specified by parameter **ages**. Otherwise the individual single mono-age subpopulations </span>
<span class="sd">            are returned (i.e., age-bins of width ``tr``, model age resolution).</span>
<span class="sd">        :type between: boolean</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``</span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.sigwr_monoage_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;between&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;W-velocity dispersion&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ages</span> <span class="o">=</span> <span class="n">inpcheck_age</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">zlim</span> <span class="o">=</span> <span class="n">inpcheck_height</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{ \ at \ |z|=[}$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span>\
                         <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$\mathrm{] \ kpc}$&#39;</span>
        <span class="n">nage</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;between&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">nage</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
                   
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ages</span><span class="p">),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">ages</span><span class="p">)),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;between&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">sigw_r</span> <span class="o">=</span> <span class="n">sigwr_monoage</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
        
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_lin_</span><span class="p">(</span><span class="n">sigw_r</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">200</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">Sigt</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Sigt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ymin</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">ymin</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">//</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="k">if</span> <span class="n">ymax</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">//</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ymax</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigsh</span><span class="p">):</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigsh</span><span class="o">//</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
            
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                     
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigw&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">sigw_r</span><span class="p">[:,</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nage</span><span class="p">)],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>
                                       <span class="p">)</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">ages</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,[</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigsh</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                    <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span>
                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>   
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;tau&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">sigwr_monoage_save</span><span class="p">(</span><span class="n">sigw_r</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>    </div>


<div class="viewcode-block" id="Plotting.sigwr_monomet_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.sigwr_monomet_plt">[docs]</a>    <span class="k">def</span> <span class="nf">sigwr_monomet_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        W-velocity dispersion of mono-metallicity subpopulations as a function of Galactocentric distance.</span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.sigwr_monomet`. </span>

<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param zlim: Range of heights [*zmin,zmax*], pc. Or set of z-bin edges, pc. </span>
<span class="sd">        :type zlim: array-like </span>
<span class="sd">        :param mets: Set of metallicity bins. </span>
<span class="sd">        :type mets: array-like</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``</span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.sigwr_monomet_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span>
                        <span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;W-velocity dispersion&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">zlim</span> <span class="o">=</span> <span class="n">inpcheck_height</span><span class="p">(</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{ \ at \ |z|=[}$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span>\
                         <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$\mathrm{] \ kpc}$&#39;</span>

        <span class="n">nmet</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mets</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;feh&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">mets</span><span class="p">),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="n">mets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">mets</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">mets</span><span class="p">)),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">sigwmet</span> <span class="o">=</span> <span class="n">sigwr_monomet</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
        
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_lin_</span><span class="p">(</span><span class="n">sigwmet</span><span class="p">,[</span><span class="mi">1</span><span class="p">,</span><span class="mi">200</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">Sigt</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Sigt&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ymin</span> <span class="o">&gt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">ymin</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">//</span><span class="mi">10</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
            <span class="k">if</span> <span class="n">ymax</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">]):</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">//</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">ymax</span> <span class="o">&lt;=</span> <span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigsh</span><span class="p">):</span>
                <span class="n">ymax</span> <span class="o">=</span> <span class="mi">10</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigsh</span><span class="o">//</span><span class="mi">10</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span>  
                
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">))</span>                
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigw&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">sigwmet</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">nmet</span><span class="p">)],</span>
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>                        
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                   
                                       <span class="p">)</span>
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">mets</span><span class="p">))</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;dt&#39;</span> <span class="ow">or</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">Sigt</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;t&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">mode_comp</span><span class="o">==</span><span class="s1">&#39;tot&#39;</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,[</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">sigsh</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span>
                    <span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;sh&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">],[</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span>
                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>   
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;fe&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">sigwr_monomet_save</span><span class="p">(</span><span class="n">sigwmet</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mets</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>  </div>


<div class="viewcode-block" id="Plotting.sigwr_gas_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.sigwr_gas_plt">[docs]</a>    <span class="k">def</span> <span class="nf">sigwr_gas_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        W-velocity dispersion of the atomic and molecular gas as a function of Galactocentric distance.</span>
<span class="sd">        </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory is ``a.T[&#39;kinplt&#39;]``. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">Sigg1</span><span class="p">,</span> <span class="n">Sigg2</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Sigg1&#39;</span><span class="p">,</span><span class="s1">&#39;Sigg2&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">))</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dynamic_ylim_1d_lin_</span><span class="p">(</span><span class="n">Sigg2</span><span class="p">[</span><span class="mi">1</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">30</span><span class="p">],</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>                 
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;sigw&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_yticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="o">+</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Sigg1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Sigg1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;g1&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;g1&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Sigg2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Sigg2</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;g2&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;g2&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="n">ymax</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span>
                <span class="n">c</span><span class="o">=</span><span class="s1">&#39;darkgrey&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;kinplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;SigWR_g.&#39;</span><span class="p">,</span><span class="n">format_</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> 

        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>
    
    
<div class="viewcode-block" id="Plotting.fi_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.fi_plt">[docs]</a>    <span class="k">def</span> <span class="nf">fi_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vertical gravitational potential as a function of Galactocentric distance. </span>
<span class="sd">        Potential is normalized to ``SIGMA_E^2``. </span>

<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory is ``a.T[&#39;fiplt&#39;]``. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">cmin</span><span class="p">,</span> <span class="n">cmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">Phi</span><span class="p">,</span> <span class="n">Phi0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Phi&#39;</span><span class="p">,</span><span class="s1">&#39;Phi0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Phi</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">SIGMA_E</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">KM</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mf">0.2</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{\phi/\sigma_e^2}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Phi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Phi</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">SIGMA_E</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">KM</span><span class="o">**</span><span class="mi">2</span><span class="p">))</span> 
                                        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R_array</span><span class="p">],</span>                                                                   
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">colorbar</span><span class="p">,</span>
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">cmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">cmax</span><span class="p">)</span>                                                                   
                                       <span class="p">)</span>                                      
        <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">)</span>
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Phi0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Phi0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">SIGMA_E</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">KM</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span>
                <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]})</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;fiplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;Fiz.&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">format_</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>     </div>


<div class="viewcode-block" id="Plotting.fi_rsun_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.fi_rsun_plt">[docs]</a>    <span class="k">def</span> <span class="nf">fi_rsun_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The normalized vertical gravitational potential  </span>
<span class="sd">        for the Solar neighbourhood, at ``p.Rsun``.</span>

<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory is ``a.T[&#39;fiplt&#39;]``. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">Phi0</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Phi0&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Phi0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">SIGMA_E</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">KM</span><span class="o">**</span><span class="mi">2</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="mf">0.2</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{\phi/\sigma_e^2}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Phi0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">Phi0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">SIGMA_E</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="n">KM</span><span class="o">**</span><span class="mi">2</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">])</span>
                
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.91</span><span class="p">)</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;fiplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;Fiz_R&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">),</span>
                                                          <span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">format_</span><span class="p">))))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>     </div>


<div class="viewcode-block" id="Plotting.fi_iso_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.fi_iso_plt">[docs]</a>    <span class="k">def</span> <span class="nf">fi_iso_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        2d map (R-z plane) of the normalized gravitational potential with isolines. </span>
<span class="sd">        </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory is ``a.T[&#39;fiplt&#39;]``. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">Phi</span> <span class="o">=</span> <span class="n">fi_iso</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inp</span><span class="p">[</span><span class="s1">&#39;ah&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span>
        <span class="n">PHI</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">flip</span><span class="p">(</span><span class="n">Phi</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">),</span><span class="n">Phi</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="n">PHI</span> <span class="o">=</span> <span class="n">zoom</span><span class="p">(</span><span class="n">PHI</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">/</span><span class="mf">1e9</span>
        <span class="n">phimin</span><span class="p">,</span> <span class="n">phimax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">PHI</span><span class="p">),</span> <span class="mf">0.98</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">PHI</span><span class="p">)</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">PHI</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="o">/</span><span class="mf">1e3</span><span class="p">],</span>
                  <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gist_earth&#39;</span><span class="p">,</span><span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">phimin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">phimax</span><span class="p">))</span>                                                           
        <span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">PHI</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="o">/</span><span class="mf">1e3</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="o">/</span><span class="mf">1e3</span><span class="p">],</span>
                  <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Reds_r&#39;</span><span class="p">,</span><span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">phimin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">phimax</span><span class="p">),</span><span class="n">linewidths</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm{z, \ kpc}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;lightgrey&#39;</span><span class="p">,</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.11</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">fi_iso_save</span><span class="p">(</span><span class="n">Phi</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>     </div>


<div class="viewcode-block" id="Plotting.kz_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.kz_plt">[docs]</a>    <span class="k">def</span> <span class="nf">kz_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Vertical gravitational force of the different model components calculated </span>
<span class="sd">        for a fixed Galactocentric distance.</span>
<span class="sd">        </span>
<span class="sd">        :param R: Galactocentric distance, kpc. </span>
<span class="sd">        :type R: scalar </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory is ``a.T[&#39;fiplt&#39;]``. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">R</span><span class="o">!=</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">:</span>
            <span class="n">R</span> <span class="o">=</span> <span class="n">inpcheck_radius</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">Kz</span> <span class="o">=</span> <span class="n">tab_reader</span><span class="p">([</span><span class="s1">&#39;Kz&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="n">R</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Kz</span><span class="p">[</span><span class="mi">0</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">Kz</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">][:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span>
                    <span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;z&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;kz&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;$\mathrm{R=}$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$\mathrm{\ kpc}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]},</span><span class="n">loc</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.05</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">Kz</span><span class="p">[</span><span class="mi">1</span><span class="p">:]))</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        
        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;fiplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;Kz_R&#39;</span><span class="p">,</span><span class="nb">str</span><span class="p">(</span><span class="n">R</span><span class="p">),</span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="n">format_</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>     </div>

    
<div class="viewcode-block" id="Plotting.rot_curve_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.rot_curve_plt">[docs]</a>    <span class="k">def</span> <span class="nf">rot_curve_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Rotation curve as follows from the assumed MW mass model.</span>
<span class="sd">        </span>
<span class="sd">        :param R: Optional. Galactocentric distance grid, kpc. </span>
<span class="sd">        :type R: array-like </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory is ``a.T[&#39;kinplt&#39;]``. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>

<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;R&#39;</span><span class="p">])</span>
        
        <span class="n">rc</span> <span class="o">=</span> <span class="n">rot_curve</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inp</span><span class="p">[</span><span class="s1">&#39;ah&#39;</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;g1&#39;</span><span class="p">,</span><span class="s1">&#39;g2&#39;</span><span class="p">,</span><span class="s1">&#39;dh&#39;</span><span class="p">]</span>
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rc</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">rc</span><span class="p">[</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="s1">&#39;$\mathrm</span><span class="si">{Total}</span><span class="s1">$&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">components</span><span class="p">)):</span>
            <span class="n">k</span> <span class="o">=</span> <span class="n">components</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">rc</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">rc</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">cols</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">],[</span><span class="mi">0</span><span class="p">,</span><span class="mi">350</span><span class="p">],</span><span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span>
                <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">labs</span><span class="p">[</span><span class="s1">&#39;r0&#39;</span><span class="p">])</span>   
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">rc</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">350</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm{V_c,\ km \ s^{-1}}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>          

        <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">figname</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="s1">&#39;kinplt&#39;</span><span class="p">],</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">((</span><span class="s1">&#39;Vc_R.&#39;</span><span class="p">,</span><span class="n">format_</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figsave_</span><span class="p">(</span><span class="n">figname</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> </div>


<div class="viewcode-block" id="Plotting.fw_hist_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.fw_hist_plt">[docs]</a>    <span class="k">def</span> <span class="nf">fw_hist_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        |W|-velocity distribution function. Plotting for :func:`jjmodel.analysis.fw_hist`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component. Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total).</span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param R: Galactocentric distance, kpc. Can be a single distance bin or a set of bins. </span>
<span class="sd">        :type R: scalar or array-like </span>
<span class="sd">        :param zlim: Range of heights, pc. Can be a single slice [*zmin,zmax*] or a set of z-bin edges. </span>
<span class="sd">        :type zlim: array-like </span>
<span class="sd">        :param ages: Optional. Set of age bins, Gyr. </span>
<span class="sd">        :type ages: array-like</span>
<span class="sd">        :param mets: Optional. Set of metallicity bins. </span>
<span class="sd">        :type mets: array-like</span>
<span class="sd">        :param wmax: Maximum value of |W|-velocity, :math:`\mathrm{km \ s^{-1}}`. </span>
<span class="sd">        :type wmax: scalar</span>
<span class="sd">        :param dw: Step in |W|-velocity, :math:`\mathrm{km \ s^{-1}}`. </span>
<span class="sd">        :type dw: scalar</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table, parameter alternative to **mode_pop**. </span>
<span class="sd">            For a single radius **R** and **mode_comp** = ``&#39;tot&#39;``, </span>
<span class="sd">            **tab** must be organized as a list of tables corresponding to this **R**: [*table_d*,*table_t*,table_sh*]. </span>
<span class="sd">            If **R** is an array, then **tab** is [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are the minimum and maximum values from **R**. If **R** is not specified, *rmin* and *rmax* </span>
<span class="sd">            correspond to ``p.Rmin`` and ``p.Rmax``. </span>
<span class="sd">        :type tab: astropy table or list[astropy table], or list[list[astropy table]]</span>
<span class="sd">        :param number: Optional. If True, calculated quantity is weighted by the spatial number density of stars (:math:`\mathrm{number \ pc^{-3}}`),</span>
<span class="sd">             not matter density (:math:`\mathrm{M_\odot \ pc^{-3}}`). Active only when **mode_pop** or **tab** is given. </span>
<span class="sd">        :type number: boolean</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str     </span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.fw_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;wmax&#39;</span><span class="p">,</span><span class="s1">&#39;dw&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;ages&#39;</span><span class="p">,</span><span class="s1">&#39;mets&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;W-velocity dispersion&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">run_mode</span><span class="o">==</span><span class="mi">1</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">R</span> <span class="o">=</span> <span class="n">inpcheck_radius</span><span class="p">(</span><span class="n">R</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">R</span> <span class="o">=</span> <span class="p">[</span><span class="n">inpcheck_radius</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">R</span><span class="p">]</span>       
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;dw&#39;</span><span class="p">,</span><span class="s1">&#39;wmax&#39;</span><span class="p">,</span><span class="s1">&#39;zlim&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;number&#39;</span><span class="p">,</span><span class="s1">&#39;ages&#39;</span><span class="p">,</span><span class="s1">&#39;mets&#39;</span><span class="p">])</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>   
        <span class="n">wmax</span> <span class="o">=</span> <span class="mi">60</span>              
        <span class="k">if</span> <span class="s1">&#39;wmax&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">wmax</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;wmax&#39;</span><span class="p">]</span>           
        
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">])</span><span class="o">!=</span><span class="nb">list</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{ \ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{ \ (custom \ population)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;ages&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;ages&#39;</span><span class="p">])</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{\ of \ \tau = [}$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;ages&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span>\
                    <span class="nb">str</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;ages&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{] \ Gyr}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;mets&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">])</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{\ of \ [Fe/H] = [}$&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="s1">&#39;,&#39;</span> <span class="o">+</span>\
                <span class="nb">str</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{]}$&#39;</span>
        <span class="k">if</span> <span class="p">((</span><span class="s1">&#39;cbar&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="p">(</span><span class="s1">&#39;cbar_bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">))</span> <span class="ow">and</span>
            <span class="p">((</span><span class="s1">&#39;ages&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ages&#39;</span><span class="p">])</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">!=</span><span class="nb">list</span> <span class="ow">and</span> 
             <span class="p">(</span><span class="s1">&#39;mets&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">])</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">this_function</span> <span class="o">+</span> <span class="s2">&quot;: Unnecessary input. Keywords &#39;cbar&#39; and &#39;cbar_bins&#39; &quot;</span><span class="o">+</span>\
                  <span class="s2">&quot;don&#39;t work with this combination of parameters.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">!=</span><span class="nb">list</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{\ at \ R = }$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">R</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{\ kpc}$&#39;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">ln</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{\ and \ |z| = [}$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$\mathrm{]\ kpc}$&#39;</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">ln</span> <span class="o">+=</span> <span class="sa">r</span><span class="s1">&#39;$\mathrm{\ at \ |z| = [}$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$\mathrm{]\ kpc}$&#39;</span> 
        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">wmax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm{|W|, \ km \ s^{-1}}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm{f(|W|)}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">ln</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span><span class="n">pad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>        
            
        <span class="k">if</span> <span class="p">(</span><span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">])</span><span class="o">==</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">this_function</span><span class="o">+</span><span class="s2">&quot;: Multiple populations and multiple R-bins are not allowed.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">this_function</span><span class="o">+</span><span class="s2">&quot;: Multiple populations and multiple z-bins are not allowed.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;ages&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;ages&#39;</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">this_function</span><span class="o">+</span><span class="s2">&quot;: Multiple populations and multiple age-bins are not allowed.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;mets&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">this_function</span><span class="o">+</span><span class="s2">&quot;: Multiple populations and multiple [Fe/H]-bins are not allowed.&quot;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span><span class="p">:</span>
                <span class="n">npop</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">])</span>
                <span class="n">xname</span> <span class="o">=</span> <span class="s1">&#39;mode_pop&#39;</span>
                <span class="n">xcols</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">popcols</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span>
                <span class="n">xlabels</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span>
            <span class="n">fw_list</span> <span class="o">=</span> <span class="p">[]</span> 
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npop</span><span class="p">):</span>
                <span class="n">kwargs_calc2</span> <span class="o">=</span> <span class="n">kwargs_calc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">kwargs_calc2</span><span class="p">[</span><span class="n">xname</span><span class="p">]</span>
                <span class="n">kwargs_calc2</span><span class="p">[</span><span class="n">xname</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwargs_calc</span><span class="p">[</span><span class="n">xname</span><span class="p">][</span><span class="n">i</span><span class="p">]</span>
                <span class="n">fw</span><span class="p">,</span> <span class="n">wgrid</span> <span class="o">=</span> <span class="n">fw_hist</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc2</span><span class="p">)</span> 
                <span class="n">fw_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fw</span><span class="p">)</span>
                <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wgrid</span><span class="p">,</span><span class="n">fw</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="n">xcols</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">label</span><span class="o">=</span><span class="n">xlabels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>                                                
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">fw_list</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.01</span><span class="p">)</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">]},</span><span class="n">loc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ncol</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="p">((</span><span class="s1">&#39;ages&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;ages&#39;</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)</span> <span class="ow">or</span> 
            <span class="p">(</span><span class="s1">&#39;mets&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">)):</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">this_function</span><span class="o">+</span><span class="s2">&quot;: Multiple age- or [Fe/H]-bins and multiple R-bins are not allowed.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">this_function</span><span class="o">+</span><span class="s2">&quot;: Multiple age- or [Fe/H]-bins and multiple z-bins are not allowed.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">])</span><span class="o">==</span><span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">this_function</span><span class="o">+</span><span class="s2">&quot;: Multiple age- or [Fe/H]-bins and multiple populations are not allowed.&quot;</span><span class="p">)</span>

            <span class="k">if</span> <span class="s1">&#39;ages&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span><span class="p">:</span>
                <span class="n">npop</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;ages&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">xcols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;tau&#39;</span><span class="p">,</span><span class="n">npop</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">xname</span> <span class="o">=</span> <span class="s1">&#39;ages&#39;</span>
                <span class="n">xbar</span> <span class="o">=</span> <span class="s1">&#39;tau&#39;</span>
                <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">tp</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;ages&#39;</span><span class="p">])),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">npop</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">])</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">xcols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;feh&#39;</span><span class="p">,</span><span class="n">npop</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">xname</span> <span class="o">=</span> <span class="s1">&#39;mets&#39;</span>
                <span class="n">xbar</span> <span class="o">=</span> <span class="s1">&#39;fe&#39;</span>
                <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span>
                                               <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">])),</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>  
                <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">                cbar_ticks = np.arange(kwargs_calc[&#39;mets&#39;][0],kwargs_calc[&#39;mets&#39;][-1]+0.1,0.1)</span>
<span class="sd">                if &#39;cbar_bins&#39; in kwargs and kwargs[&#39;cbar_bins&#39;]==True:</span>
<span class="sd">                    dmet = np.mean(np.diff(kwargs_calc[&#39;mets&#39;]))</span>
<span class="sd">                    #cbar_ticks = np.add(kwargs_calc[&#39;mets&#39;],dmet/2)[:-1]</span>
<span class="sd">                &#39;&#39;&#39;</span>
            <span class="n">fw_list</span> <span class="o">=</span> <span class="p">[]</span> 
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npop</span><span class="p">):</span>
                <span class="n">kwargs_calc2</span> <span class="o">=</span> <span class="n">kwargs_calc</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">del</span> <span class="n">kwargs_calc2</span><span class="p">[</span><span class="n">xname</span><span class="p">]</span>
                <span class="n">kwargs_calc2</span><span class="p">[</span><span class="n">xname</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="n">xname</span><span class="p">][</span><span class="n">i</span><span class="p">],</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="n">xname</span><span class="p">][</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span>
                <span class="n">fw</span><span class="p">,</span> <span class="n">wgrid</span> <span class="o">=</span> <span class="n">fw_hist</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc2</span><span class="p">)</span>
                <span class="n">fw_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fw</span><span class="p">)</span>
            <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">wgrid</span><span class="p">,</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fw_list</span><span class="p">],</span>   
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">xcols</span><span class="p">,</span>
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">xmax</span><span class="p">)</span>                                                                   
                                       <span class="p">)</span>                                      
            <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="n">xname</span><span class="p">])</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;ages&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span><span class="p">:</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;ticks&#39;</span><span class="p">])</span>
                <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticklabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">xt</span><span class="p">[</span><span class="s1">&#39;labels&#39;</span><span class="p">])</span>
            <span class="c1">#else:</span>
            <span class="c1">#    cbar.set_ticks(cbar_ticks)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="n">xbar</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>   
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">fw_list</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.01</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">2</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">==</span><span class="nb">list</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;ages&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;ages&#39;</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">this_function</span><span class="o">+</span><span class="s2">&quot;: Multiple R- or z-bins and multiple age-bins are not allowed.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;mets&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">])</span><span class="o">&gt;</span><span class="mi">2</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">this_function</span><span class="o">+</span><span class="s2">&quot;: Multiple R- or z-bins and multiple [Fe/H]-bins are not allowed.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs_calc</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs_calc</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">])</span><span class="o">==</span><span class="nb">list</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">this_function</span><span class="o">+</span><span class="s2">&quot;: Multiple R- or z-bins and multiple populations are not allowed.&quot;</span><span class="p">)</span>
            
            <span class="k">try</span><span class="p">:</span>
                <span class="n">npop</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">R</span><span class="p">)</span>
                <span class="n">xcols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="n">npop</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">R_array</span> <span class="o">=</span> <span class="n">R</span>
                <span class="n">zlim_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">zlim</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">npop</span><span class="p">)]</span>
                <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_cbarminmax_</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">xarray</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span>
                <span class="n">xname</span> <span class="o">=</span> <span class="s1">&#39;r&#39;</span>
                <span class="n">cbar_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="k">if</span> <span class="s1">&#39;cbar_bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
                    <span class="n">cbar_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="o">/</span><span class="mi">2</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">except</span><span class="p">:</span>
                <span class="n">npop</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">xcols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="n">npop</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="n">zlim_array</span> <span class="o">=</span> <span class="p">[[</span><span class="n">zlim</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">zlim</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">npop</span><span class="p">)]</span>
                <span class="n">R_array</span> <span class="o">=</span> <span class="p">[</span><span class="n">R</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">npop</span><span class="p">)]</span>
                <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="o">/</span><span class="mf">1e3</span>
                <span class="n">xarray</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span>
                <span class="n">xname</span> <span class="o">=</span> <span class="s1">&#39;zkpc&#39;</span>
                <span class="n">dz</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">zlim</span><span class="p">))</span>
                <span class="n">cbar_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dz</span><span class="p">,</span><span class="n">dz</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span>
                <span class="k">if</span> <span class="s1">&#39;cbar_bins&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">and</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">]</span><span class="o">==</span><span class="kc">True</span><span class="p">:</span>
                    <span class="n">cbar_ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="n">dz</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">zlim</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">dz</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="n">dz</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span>
                
            <span class="n">fw_list</span> <span class="o">=</span> <span class="p">[]</span> 
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">npop</span><span class="p">):</span>
                <span class="n">fw</span><span class="p">,</span> <span class="n">wgrid</span> <span class="o">=</span> <span class="n">fw_hist</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">R_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">zlim_array</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
                <span class="n">fw_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fw</span><span class="p">)</span>
            <span class="n">line_segments</span> <span class="o">=</span> <span class="n">LineCollection</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">wgrid</span><span class="p">,</span><span class="n">i</span><span class="p">))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">fw_list</span><span class="p">],</span>   
                                       <span class="n">linewidths</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">cmap</span> <span class="o">=</span> <span class="n">xcols</span><span class="p">,</span>
                                       <span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">xmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">xmax</span><span class="p">)</span>                                                                                                                                      
                                       <span class="p">)</span>                                      
            <span class="n">line_segments</span><span class="o">.</span><span class="n">set_array</span><span class="p">(</span><span class="n">xarray</span><span class="p">)</span>
            <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">add_collection</span><span class="p">(</span><span class="n">line_segments</span><span class="p">)</span>
            <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
            <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
            <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="n">xname</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
            <span class="n">cbar</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">cbar_ticks</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">fw_list</span><span class="p">),</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="mf">0.01</span><span class="p">)</span>
            
                       
        <span class="k">if</span> <span class="p">((</span><span class="s1">&#39;mode_pop&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="nb">type</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">])</span><span class="o">!=</span><span class="nb">list</span><span class="p">)</span> <span class="ow">and</span>
            <span class="p">(</span><span class="s1">&#39;ages&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;ages&#39;</span><span class="p">])</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> 
            <span class="p">(</span><span class="s1">&#39;mets&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">kwargs</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mets&#39;</span><span class="p">])</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="ow">and</span>
            <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zlim</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">type</span><span class="p">(</span><span class="n">R</span><span class="p">)</span><span class="o">!=</span><span class="nb">list</span><span class="p">):</span>
            
            <span class="n">fw</span><span class="p">,</span> <span class="n">wgrid</span> <span class="o">=</span> <span class="n">fw_hist</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span> 
            <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wgrid</span><span class="p">,</span><span class="n">fw</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mf">1.05</span><span class="o">*</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">fw</span><span class="p">)</span><span class="o">+</span><span class="mf">0.001</span><span class="p">))</span>
            <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">fw_save</span><span class="p">((</span><span class="n">fw</span><span class="p">,</span><span class="n">wgrid</span><span class="p">),</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">R</span><span class="p">,</span><span class="n">zlim</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>     </div>
    
    
<div class="viewcode-block" id="Plotting.disk_brightness_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.disk_brightness_plt">[docs]</a>    <span class="k">def</span> <span class="nf">disk_brightness_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">mode_geom</span><span class="p">,</span><span class="n">bands</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Surface brightness or colour profile of the MW viewed edge-on or face-on. </span>
<span class="sd">        Plotting for :func:`jjmodel.analysis.disk_brightness`. </span>
<span class="sd">    </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total). </span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param mode_geom: Modeled geometry. Disk orientation with respect to the observer: ``&#39;face-on&#39;`` or ``&#39;edge-on&#39;``. </span>
<span class="sd">        :type mode_geom: str</span>
<span class="sd">        :param bands: If a string, this parameter corresponds to the band for the surface brightness profile. </span>
<span class="sd">            If it is a list, then **bands** gives the names of two bands to be used for the color profile - e.g. </span>
<span class="sd">            ``[&#39;U&#39;,&#39;V&#39;]`` for *U-V*.</span>
<span class="sd">        :type bands: str or list</span>
<span class="sd">        :param zlim: Optional. Range of heights [*zmim,zmax*] to be considered, pc. If not given, </span>
<span class="sd">            all heights up to ``p.zmax`` are taken into account.</span>
<span class="sd">        :type zlim: array-like</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param tab: Optional. Stellar assemblies table(s), parameter alternative to **mode_pop**. </span>
<span class="sd">            If **mode_comp** = ``&#39;tot&#39;``, **tab** must be [[*table_d,table_t,table_sh*]_ *rmin*,...,[*table_d,table_t,table_sh*]_ *rmax*], </span>
<span class="sd">            where *rmin* and *rmax* are ``p.Rmin`` and ``p.Rmax``</span>
<span class="sd">        :type tab: list[astropy table] or list[list[astropy table]] </span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.disk_brightness_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;zlim&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;tab&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">],</span>
                        <span class="n">this_function</span><span class="p">)</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;disk brightness/colour profile&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode_geom</span><span class="o">==</span><span class="s1">&#39;face-on&#39;</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ face-on}$&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ edge-on}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;mode_pop&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (}$&#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">]]</span> <span class="o">+</span> <span class="s1">&#39;$\mathrm{)}$&#39;</span>
        <span class="k">if</span> <span class="s1">&#39;tab&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{\ (custom \ population)}$&#39;</span>
        <span class="k">if</span> <span class="n">mode_geom</span><span class="o">==</span><span class="s1">&#39;edge-on&#39;</span><span class="p">:</span>
            <span class="n">zlim</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">zmax</span><span class="p">]</span>
            <span class="k">if</span> <span class="s1">&#39;zlim&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="n">zlim</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;zlim&#39;</span><span class="p">]</span>
            <span class="n">ln</span> <span class="o">+=</span> <span class="s1">&#39;$\mathrm{ \ for \ |z|=[}$&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;,&#39;</span><span class="o">+</span>\
                             <span class="nb">str</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">zlim</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">)</span><span class="o">/</span><span class="mf">1e3</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;$\mathrm{] \ kpc}$&#39;</span>
                         
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;zlim&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>                
        <span class="n">profile</span> <span class="o">=</span> <span class="n">disk_brightness</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">mode_geom</span><span class="p">,</span><span class="n">bands</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>

        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">9</span><span class="p">,</span><span class="mi">7</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">profile</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">lw</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span><span class="n">markersize</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;g&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axts</span><span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">],</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span><span class="p">:</span>
            <span class="n">bands_string</span> <span class="o">=</span> <span class="n">bands</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">bands_string</span><span class="p">)</span><span class="o">==</span><span class="mi">2</span><span class="p">:</span>
                <span class="n">bands_string</span> <span class="o">=</span> <span class="n">bands_string</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;\_&#39;</span><span class="o">+</span><span class="n">bands_string</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm{\mu_{&#39;</span><span class="o">+</span><span class="n">bands_string</span><span class="o">+</span><span class="s1">&#39;}, \ mag \ arcsec^{-2}}$&#39;</span><span class="p">,</span>
                          <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">bands_string1</span> <span class="o">=</span> <span class="n">bands</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="n">bands_string2</span> <span class="o">=</span> <span class="n">bands</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="n">bands_string1</span> <span class="o">=</span> <span class="n">bands_string1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;\_&#39;</span><span class="o">+</span><span class="n">bands_string1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">bands_string2</span> <span class="o">=</span> <span class="n">bands_string2</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;\_&#39;</span><span class="o">+</span><span class="n">bands_string2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm{&#39;</span><span class="o">+</span><span class="n">bands_string1</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">bands_string2</span><span class="o">+</span><span class="s1">&#39;}$&#39;</span><span class="p">,</span>
                          <span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
        <span class="c1">#plt.legend(prop={&#39;size&#39;:self.fnt[&#39;secondary&#39;]},loc=2,ncol=2)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rmax</span><span class="p">)</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="nb">round</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">amin</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span><span class="o">-</span><span class="mf">0.5</span><span class="p">),</span><span class="mi">0</span><span class="p">),</span> <span class="nb">round</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">amax</span><span class="p">(</span><span class="n">profile</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ymin</span><span class="o">==</span><span class="n">ymax</span><span class="p">:</span>
            <span class="n">ymin</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">-</span> <span class="mf">0.5</span> 
            <span class="n">ymax</span> <span class="o">=</span> <span class="n">ymin</span> <span class="o">+</span> <span class="mi">1</span> 
        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">bands</span><span class="p">)</span><span class="o">==</span><span class="nb">str</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">ymin</span><span class="p">,</span><span class="n">ymax</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.14</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.86</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.86</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;save_format&#39;</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;save_format&#39;</span><span class="p">]</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">disk_brightness_save</span><span class="p">(</span><span class="n">profile</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">mode_geom</span><span class="p">,</span><span class="n">bands</span><span class="p">)</span>  
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>     </div>
    
    
<div class="viewcode-block" id="Plotting.hess_simple_plt"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.Plotting.hess_simple_plt">[docs]</a>    <span class="k">def</span> <span class="nf">hess_simple_plt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">mode_geom</span><span class="p">,</span><span class="n">bands</span><span class="p">,</span><span class="n">mag_range</span><span class="p">,</span><span class="n">mag_step</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Hess diagram for the simple volumes. PLotting for :func:`jjmodel.analysis.hess_simple`. </span>
<span class="sd">        </span>
<span class="sd">        :param mode_comp: Galactic component, can be ``&#39;d&#39;``, ``&#39;t&#39;``, ``&#39;sh&#39;``, ``&#39;dt&#39;``, or ``&#39;tot&#39;`` </span>
<span class="sd">            (thin disk, thick disk, halo, thin+thick disk, or total).</span>
<span class="sd">        :type mode_comp: str</span>
<span class="sd">        :param mode_geom: Modeled geometry. Can be ``&#39;local_sphere&#39;``, ``&#39;local_cylinder&#39;``, or ``&#39;rphiz_box&#39;``. </span>
<span class="sd">        :type mode_geom: str</span>
<span class="sd">        :param bands: List of names of photometric columns. </span>
<span class="sd">            Three column names must be given, e.g. ``[&#39;B&#39;,&#39;V&#39;,&#39;V&#39;]`` for (*B-V*) versus :math:`M_\mathrm{V}`. </span>
<span class="sd">        :type bands: list[str]</span>
<span class="sd">        :param mag_range: Minimal and maximal magnitude along the x- and y-axis of the Hess </span>
<span class="sd">            diagram, [[*x_min,x_max*],[*y_min,y_max*]]. </span>
<span class="sd">        :type mag_range: list[list[scalar]]</span>
<span class="sd">        :param mag_step: Step along the x- and y-axis of the Hess diagram, [*dx,dy*]. </span>
<span class="sd">        :type mag_step: array-like</span>
<span class="sd">        :param mode_pop: Optional. Name of stellar population. Can be a pre-defined one </span>
<span class="sd">            (``&#39;a&#39;``, ``&#39;f&#39;``, ``&#39;ceph&#39;``, ``&#39;rc&#39;``, ``&#39;rc+&#39;``, ``&#39;gdw&#39;``, ``&#39;kdw&#39;``, ``&#39;mdw&#39;``) or custom </span>
<span class="sd">            (if it was selected and saved as a table in advance). </span>
<span class="sd">        :type mode_pop: str</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str</span>
<span class="sd">        :param r_minmax: Optional. Minimal and maximal radius of the spherical shell if **mode_geom** is ``&#39;sphere&#39;`` </span>
<span class="sd">            or minimal and maximal radius of the cylindrical shell if **mode_geom** is ``&#39;cylinder&#39;``, pc.   </span>
<span class="sd">        :type r_minmax: array-like</span>
<span class="sd">        :param R_minmax: Optional. Minimal and maximal Galactocentric distance if **mode_geom** is ``&#39;rphiz_box&#39;``, kpc. </span>
<span class="sd">        :type R_minmax: array-like</span>
<span class="sd">        :param dphi: Optional. Minimal and maximal Galactic angle :math:`\\phi` if **mode_geom** is &#39;rphiz_box&#39;, deg.</span>
<span class="sd">        :type dphi: array-like</span>
<span class="sd">        :param smooth: Optional. Width of the smoothing window in x and y, mag. </span>
<span class="sd">        :type smooth: array-like</span>
<span class="sd">        :param zlim: Optional. Range of heights [*zmim,zmax*] to be considered, pc.</span>
<span class="sd">        :type zlim: array-like</span>
<span class="sd">        :param cbar: Optional. Matplotlib colormap name. </span>
<span class="sd">        :type cbar: str</span>
<span class="sd">        :param cbar_bins: Optional. If True, the colorbar will be discrete. </span>
<span class="sd">            By default, it is continious.  </span>
<span class="sd">        :param save: Optional. If True, the figure will be saved. </span>
<span class="sd">            The output directory and figure name </span>
<span class="sd">            are prescribed by jjmodel.iof.TabSaver.hess_save. </span>
<span class="sd">        :type save: boolean</span>
<span class="sd">        :param save_format: Optional. Format of the figure. </span>
<span class="sd">        :type save_format: str </span>
<span class="sd">        :param close: Optional. If True, the figure window is closed in the end.</span>
<span class="sd">        :type close: boolean</span>
<span class="sd">        </span>
<span class="sd">        :return: Figure and axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="n">inpcheck_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;save_format&#39;</span><span class="p">,</span><span class="s1">&#39;close&#39;</span><span class="p">,</span><span class="s1">&#39;cbar&#39;</span><span class="p">,</span><span class="s1">&#39;cbar_bins&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">,</span>
                                <span class="s1">&#39;zlim&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;r_minmax&#39;</span><span class="p">,</span><span class="s1">&#39;R_minmax&#39;</span><span class="p">,</span><span class="s1">&#39;smooth&#39;</span><span class="p">,</span><span class="s1">&#39;dphi&#39;</span><span class="p">],</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">kwargs_calc</span> <span class="o">=</span> <span class="n">reduce_kwargs</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,[</span><span class="s1">&#39;zlim&#39;</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="s1">&#39;mode_pop&#39;</span><span class="p">,</span><span class="s1">&#39;r_minmax&#39;</span><span class="p">,</span><span class="s1">&#39;R_minmax&#39;</span><span class="p">,</span><span class="s1">&#39;smooth&#39;</span><span class="p">,</span>
                                            <span class="s1">&#39;dphi&#39;</span><span class="p">,</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">])</span>
        <span class="n">ln</span><span class="p">,</span> <span class="n">mode_comp</span> <span class="o">=</span> <span class="n">inpcheck_mode_comp</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">],</span>
                                           <span class="s1">&#39;Hess diagram&#39;</span><span class="p">,</span><span class="n">this_function</span><span class="p">)</span>
        <span class="n">inpcheck_kwargs_compatibility</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="n">this_function</span><span class="p">,</span><span class="n">plt_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        
        <span class="n">hess</span> <span class="o">=</span> <span class="n">hess_simple</span><span class="p">(</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">mode_geom</span><span class="p">,</span><span class="n">bands</span><span class="p">,</span><span class="n">mag_range</span><span class="p">,</span><span class="n">mag_step</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
        <span class="n">colorbar</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figcolorbar_</span><span class="p">(</span><span class="s1">&#39;z&#39;</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="n">Ntot</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">hess</span><span class="p">)),</span><span class="mi">0</span><span class="p">))</span>
        <span class="n">hess</span><span class="p">[</span><span class="n">hess</span><span class="o">==</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span>
        <span class="n">log10_hess</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">hess</span><span class="p">)</span>
        <span class="n">xmin</span><span class="p">,</span> <span class="n">xmax</span> <span class="o">=</span> <span class="n">mag_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">ymin</span><span class="p">,</span> <span class="n">ymax</span> <span class="o">=</span> <span class="n">mag_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">hmin</span><span class="p">,</span> <span class="n">hmax</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">log10_hess</span><span class="p">)</span>
                        
        <span class="n">f</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>        
        <span class="n">im</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">log10_hess</span><span class="p">,</span><span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span><span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">xmin</span><span class="p">,</span><span class="n">xmax</span><span class="p">,</span><span class="n">ymax</span><span class="p">,</span><span class="n">ymin</span><span class="p">],</span>
                       <span class="n">cmap</span><span class="o">=</span><span class="n">colorbar</span><span class="p">,</span><span class="n">vmin</span><span class="o">=</span><span class="n">hmin</span><span class="p">,</span><span class="n">vmax</span><span class="o">=</span><span class="n">hmax</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_aspect</span><span class="p">((</span><span class="n">xmax</span><span class="o">-</span><span class="n">xmin</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">ymax</span><span class="o">-</span><span class="n">ymin</span><span class="p">))</span>
        
        <span class="n">b</span> <span class="o">=</span> <span class="p">[]</span> 
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">bands</span><span class="p">)):</span>
            <span class="n">split</span> <span class="o">=</span> <span class="n">bands</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span>
            <span class="n">bsplit</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">split</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">k</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                    <span class="n">bsplit</span> <span class="o">+=</span> <span class="s1">&#39;\_&#39;</span> <span class="o">+</span> <span class="n">split</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">bsplit</span> <span class="o">+=</span> <span class="n">split</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bsplit</span><span class="p">)</span>
        
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm{&#39;</span><span class="o">+</span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;-&#39;</span><span class="o">+</span><span class="n">b</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;$\mathrm{&#39;</span><span class="o">+</span><span class="n">b</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s1">&#39;}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span><span class="mf">0.05</span><span class="p">,</span><span class="s1">&#39;$\mathrm{N=&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">Ntot</span><span class="p">)</span><span class="o">+</span><span class="s1">&#39;}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;secondary&#39;</span><span class="p">],</span><span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">transAxes</span><span class="p">)</span>
        <span class="n">f</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">bottom</span><span class="o">=</span><span class="mf">0.18</span><span class="p">,</span><span class="n">left</span><span class="o">=</span><span class="mf">0.08</span><span class="p">,</span><span class="n">right</span><span class="o">=</span><span class="mf">0.94</span><span class="p">,</span><span class="n">top</span><span class="o">=</span><span class="mf">0.93</span><span class="p">)</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_position</span><span class="p">()</span>
        <span class="n">cax</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">add_axes</span><span class="p">([</span><span class="n">pos</span><span class="o">.</span><span class="n">x0</span><span class="o">+</span><span class="n">pos</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mf">0.02</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">y0</span><span class="p">,</span><span class="mf">0.025</span><span class="p">,</span><span class="n">pos</span><span class="o">.</span><span class="n">height</span><span class="p">])</span>
        <span class="n">cbar</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span><span class="n">cax</span><span class="o">=</span><span class="n">cax</span><span class="p">,</span><span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">)</span>
        <span class="n">cbar</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$\mathrm{log_</span><span class="si">{10}</span><span class="s1"> \ N \ [&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">mag_step</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">+</span>
                       <span class="sa">r</span><span class="s1">&#39;\times&#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">mag_step</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">+</span><span class="s1">&#39;] \ mag^{-2}}$&#39;</span><span class="p">,</span><span class="n">fontsize</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">fnt</span><span class="p">[</span><span class="s1">&#39;main&#39;</span><span class="p">],</span><span class="n">labelpad</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwargs</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">,</span><span class="kc">True</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">format_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_figformat_</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="n">ts</span> <span class="o">=</span> <span class="n">TabSaver</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span><span class="n">fig</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">save_format</span><span class="o">=</span><span class="n">format_</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs_calc</span><span class="p">)</span>
            <span class="n">ts</span><span class="o">.</span><span class="n">hess_save</span><span class="p">(</span><span class="n">hess</span><span class="p">,</span><span class="n">mode_comp</span><span class="p">,</span><span class="n">mode_geom</span><span class="p">,</span><span class="n">bands</span><span class="p">,</span><span class="n">mag_range</span><span class="p">,</span><span class="n">mag_step</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_figclose_</span><span class="p">(</span><span class="n">this_function</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">return</span> <span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>     </div></div>
        
            

<div class="viewcode-block" id="PlotBlocks"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.PlotBlocks">[docs]</a><span class="k">class</span> <span class="nc">PlotBlocks</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Class to plot and save many figures automatically. </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
<div class="viewcode-block" id="PlotBlocks.__init__"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.PlotBlocks.__init__">[docs]</a>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">inp</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Class is initialized with tuples p and a and dictionary ``inp``. </span>
<span class="sd">        </span>
<span class="sd">        :param p: Set of model parameters from the parameter file. </span>
<span class="sd">        :type p: namedtuple</span>
<span class="sd">        :param a: Collection of the fixed model parameters, useful quantities, and arrays.</span>
<span class="sd">        :type a: namedtuple</span>
<span class="sd">        :param inp: Collection of the input functions including SFR, AVR, AMR, and IMF.</span>
<span class="sd">        :type inp: dict   </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span> <span class="o">=</span> <span class="n">Plotting</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">a</span><span class="p">,</span><span class="n">inp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">inp</span> <span class="o">=</span> <span class="n">a</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">inp</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modes_full</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;sh&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;t&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;d&#39;</span><span class="p">,</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="s1">&#39;tot&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;close&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span><span class="s1">&#39;save&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pops</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;a&#39;</span><span class="p">,</span><span class="s1">&#39;f&#39;</span><span class="p">,</span><span class="s1">&#39;rc&#39;</span><span class="p">,</span><span class="s1">&#39;gdw&#39;</span><span class="p">,</span><span class="s1">&#39;kdw&#39;</span><span class="p">]</span></div>
        
        
<div class="viewcode-block" id="PlotBlocks.model_input"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.PlotBlocks.model_input">[docs]</a>    <span class="k">def</span> <span class="nf">model_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwgs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots and saves all model input: radial density profiles </span>
<span class="sd">        of the Galactic components, SFR, mass loss, gas scale heights. </span>
<span class="sd">        </span>
<span class="sd">        :param print_time: Optional. If True, calculation time is printed. </span>
<span class="sd">        :type print_time: boolean </span>
<span class="sd">        </span>
<span class="sd">        :return: None. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
            <span class="n">t_start</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
    
        <span class="c1"># For the Solar neighbourhood</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">run_mode</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">amr_rsun_plt</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">g_rsun_plt</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">nsfr_rsun_plt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">]</span>
    
        <span class="c1"># For the whole disk</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">amrr_plt</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">gr_plt</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">nsfr_plt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhor_plt</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">hr_gas_plt</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">PlotBlocks.model_input : &#39;</span><span class="p">,</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">t_start</span><span class="p">))</span></div>

        
<div class="viewcode-block" id="PlotBlocks.densities"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.PlotBlocks.densities">[docs]</a>    <span class="k">def</span> <span class="nf">densities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="n">kwgs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots and saves predicted vertical and radial profiles  </span>
<span class="sd">        of the Galactic components and of the disk&#39;s mono-age and mono-metallicity subpopulations. </span>
<span class="sd">        </span>
<span class="sd">        :param zlim: Single z-bin [*zmin,zmax*], where the quantity will be calculated, pc. </span>
<span class="sd">        :type zlim: array-like</span>
<span class="sd">        :param ages: Set of age bins, Gyr. </span>
<span class="sd">        :type ages: array-like</span>
<span class="sd">        :param mets: Set of meallicity bins. </span>
<span class="sd">        :type mets: array-like</span>
<span class="sd">        :param print_time: Optional. If True, calculation time is printed. </span>
<span class="sd">        :type print_time: boolean </span>
<span class="sd">        </span>
<span class="sd">        :return: None. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
            <span class="n">t_start</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        
        <span class="c1"># In any case</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhoz_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>    
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhoz_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhoz_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">cumulative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhoz_monoage_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="n">between</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhoz_monomet_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>      
                
        <span class="c1"># For the whole disk</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">run_mode</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">Rbins</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhoz_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>    
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhoz_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">normalized</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhoz_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">cumulative</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">)):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhoz_monoage_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">ages</span><span class="p">,</span><span class="n">between</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhor_monoage_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="n">between</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                    <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
                        <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhoz_monomet_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhor_monomet_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">zlim</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">PlotBlocks.densities : &#39;</span><span class="p">,</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">t_start</span><span class="p">))</span></div>
        
        
<div class="viewcode-block" id="PlotBlocks.ages"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.PlotBlocks.ages">[docs]</a>    <span class="k">def</span> <span class="nf">ages</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zlim_set</span><span class="p">,</span><span class="n">age_sm</span><span class="p">,</span><span class="o">**</span><span class="n">kwgs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots and saves disk&#39;s age distributions at different heights and Galactocentric distances. </span>
<span class="sd">        </span>
<span class="sd">        :param zlim_set: Edges of z-bins where the quantity will be calculated. </span>
<span class="sd">        :type zlim_set: array-like</span>
<span class="sd">        :param age_sm: Standard deviation of the Gaussian kernel, which is used </span>
<span class="sd">            to smooth age distributions, Gyr. </span>
<span class="sd">        :type age_sm: scalar   </span>
<span class="sd">        :param print_time: Optional. If True, calculation time is printed. </span>
<span class="sd">        :type print_time: boolean </span>
<span class="sd">        </span>
<span class="sd">        :return: None. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
            <span class="n">t_start</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        
        <span class="n">modes_disk</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        
        <span class="c1"># For the Solar neighbourhood</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">run_mode</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">agehist_rsun_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],[</span><span class="n">zlim_set</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
                                        <span class="n">sigma_gauss</span><span class="o">=</span><span class="n">age_sm</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">agehist_rsun_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">,</span><span class="n">sigma_gauss</span><span class="o">=</span><span class="n">age_sm</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                                        
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">agez_rsun_plt</span><span class="p">(</span><span class="s1">&#39;tot&#39;</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="c1"># For the whole disk</span>
        <span class="k">else</span><span class="p">:</span>          
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">agehist_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],[</span><span class="n">zlim_set</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
                                   <span class="n">sigma_gauss</span><span class="o">=</span><span class="n">age_sm</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">agehist_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],[</span><span class="n">zlim_set</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span><span class="n">sigma_gauss</span><span class="o">=</span><span class="n">age_sm</span><span class="p">,</span>
                                    <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zlim_set</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">agez_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">ager_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">[</span><span class="n">k</span><span class="p">],[</span><span class="n">zlim_set</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>                
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">PlotBlocks.ages : &#39;</span><span class="p">,</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">t_start</span><span class="p">))</span></div>
            
            
<div class="viewcode-block" id="PlotBlocks.metallicities"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.PlotBlocks.metallicities">[docs]</a>    <span class="k">def</span> <span class="nf">metallicities</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zlim_set</span><span class="p">,</span><span class="n">met_sm</span><span class="p">,</span><span class="o">**</span><span class="n">kwgs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots and saves disk&#39;s age distributions at different heights and Galactocentric distances. </span>
<span class="sd">        </span>
<span class="sd">        :param zlim_set: Edges of z-bins where the quantity will be calculated. </span>
<span class="sd">        :type zlim_set: array-like</span>
<span class="sd">        :param met_sm: Standard deviation of the Gaussian kernel, which is used </span>
<span class="sd">            to smooth metallicity distributions. </span>
<span class="sd">        :type met_sm: scalar   </span>
<span class="sd">        :param print_time: Optional. If True, calculation time is printed. </span>
<span class="sd">        :type print_time: boolean </span>
<span class="sd">        </span>
<span class="sd">        :return: None. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
            <span class="n">t_start</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        
        <span class="n">modes_disk</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_disk</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        
        <span class="c1"># For the Solar neighbourhood</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">run_mode</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">methist_rsun_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">,</span><span class="n">sigma_gauss</span><span class="o">=</span><span class="n">met_sm</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">methist_rsun_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],[</span><span class="n">zlim_set</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span><span class="n">sigma_gauss</span><span class="o">=</span><span class="n">met_sm</span><span class="p">,</span>
                                         <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zlim_set</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">metz_rsun_plt</span><span class="p">(</span><span class="s1">&#39;tot&#39;</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            
        <span class="c1"># For the whole disk   </span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">methist_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],[</span><span class="n">zlim_set</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
                                   <span class="n">sigma_gauss</span><span class="o">=</span><span class="n">met_sm</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">methist_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">[</span><span class="n">k</span><span class="p">],[</span><span class="n">zlim_set</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]],</span><span class="n">sigma_gauss</span><span class="o">=</span><span class="n">met_sm</span><span class="p">,</span>
                                    <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">zlim_set</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">metz_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">[</span><span class="n">k</span><span class="p">],</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">metr_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">[</span><span class="n">k</span><span class="p">],[</span><span class="n">zlim_set</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>                
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">PlotBlocks.metallicities : &#39;</span><span class="p">,</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">t_start</span><span class="p">))</span></div>
            
            
<div class="viewcode-block" id="PlotBlocks.heights"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.PlotBlocks.heights">[docs]</a>    <span class="k">def</span> <span class="nf">heights</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="n">kwgs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots and saves disk&#39;s scale heights as a function of age and Galactocentric distance. </span>
<span class="sd">        </span>
<span class="sd">        :type ages: array-like</span>
<span class="sd">        :param mets: Set of meallicity bins. </span>
<span class="sd">        :type mets: array-like</span>
<span class="sd">        :param print_time: Optional. If True, calculation time is printed. </span>
<span class="sd">        :type print_time: boolean </span>
<span class="sd">        </span>
<span class="sd">        :return: None. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
            <span class="n">t_start</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        
        <span class="c1"># For the Solar neighbourhood</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">run_mode</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">h_rsun_plt</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            
        <span class="c1"># For the whole disk</span>
        <span class="k">else</span><span class="p">:</span>      
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">h_plt</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">hr_monoage_plt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="n">between</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">]</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">hr_monomet_plt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">]</span>
    
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">PlotBlocks.heights : &#39;</span><span class="p">,</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">t_start</span><span class="p">))</span></div>
        
        
<div class="viewcode-block" id="PlotBlocks.kinematics"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.PlotBlocks.kinematics">[docs]</a>    <span class="k">def</span> <span class="nf">kinematics</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zlim_set</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="n">kwgs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots and saves disk&#39;s kinematic functions: AVR, W-velocity </span>
<span class="sd">        dispersion of the thick disk and gas at different Galactocentric distances. </span>
<span class="sd">        </span>
<span class="sd">        :param zlim_set: Edges of z-bins where the quantity will be calculated. </span>
<span class="sd">        :type zlim_set: array-like</span>
<span class="sd">        :type ages: array-like</span>
<span class="sd">        :param mets: Set of meallicity bins. </span>
<span class="sd">        :type mets: array-like</span>
<span class="sd">        :param print_time: Optional. If True, calculation time is printed. </span>
<span class="sd">        :type print_time: boolean </span>
<span class="sd">        </span>
<span class="sd">        :return: None. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
            <span class="n">t_start</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        
        <span class="n">zlim</span> <span class="o">=</span> <span class="p">[</span><span class="n">zlim_set</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]]</span>
        
        <span class="c1"># In any case</span>
        <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">fw_hist_plt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">zlim_set</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">fw_hist_plt</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="o">=</span><span class="n">ages</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">fw_hist_plt</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mets</span><span class="o">=</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="c1"># For the Solar neighbourhood</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">run_mode</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">avr_rsun_plt</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">sigwz_rsun_plt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">]</span>
            
        <span class="c1"># For the whole disk</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">avr_plt</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rot_curve_plt</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">sigwr_thick_plt</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">sigwr_gas_plt</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">sigwr_plt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">zlim_set</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">]</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">sigwr_monoage_plt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="n">between</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">]</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">sigwr_monomet_plt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">]</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">sigwr_monoage_plt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="n">between</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">]</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">sigwr_monomet_plt</span><span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes_dtot</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">fw_hist_plt</span><span class="p">(</span><span class="s1">&#39;dt&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">PlotBlocks.kinematics : &#39;</span><span class="p">,</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">t_start</span><span class="p">))</span> </div>
            
            
<div class="viewcode-block" id="PlotBlocks.potential"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.PlotBlocks.potential">[docs]</a>    <span class="k">def</span> <span class="nf">potential</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">**</span><span class="n">kwgs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots and saves vertical grvitational potential and gravitational force. </span>
<span class="sd">        </span>
<span class="sd">        :param print_time: Optional. If True, calculation time is printed. </span>
<span class="sd">        :type print_time: boolean </span>
<span class="sd">        </span>
<span class="sd">        :return: None. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
            <span class="n">t_start</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        
        <span class="c1"># In any case</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">kz_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="c1"># For the Solar neighbourhood</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">run_mode</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">fi_rsun_plt</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            
        <span class="c1"># For the whole disk</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">fi_iso_plt</span><span class="p">(</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">kz_plt</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">]</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">PlotBlocks.potential : &#39;</span><span class="p">,</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">t_start</span><span class="p">))</span></div>
            
            
<div class="viewcode-block" id="PlotBlocks.rz_maps"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.PlotBlocks.rz_maps">[docs]</a>    <span class="k">def</span> <span class="nf">rz_maps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">dz</span><span class="p">,</span><span class="o">**</span><span class="n">kwgs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots and saves density/age/[Fe/H]/sigw maps in Rz plane. </span>
<span class="sd">        </span>
<span class="sd">        :param dz: Optional. Vertical resolution, pc. </span>
<span class="sd">        :type dz: scalar</span>
<span class="sd">        :param print_time: Optional. If True, calculation time is printed. </span>
<span class="sd">        :type print_time: boolean </span>
<span class="sd">        </span>
<span class="sd">        :return: None. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
            <span class="n">t_start</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_full</span><span class="p">)):</span>    
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rz_map_plt</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_full</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">dz</span><span class="o">=</span><span class="n">dz</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">PlotBlocks.rz_maps : &#39;</span><span class="p">,</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">t_start</span><span class="p">))</span></div>
                        
            
<div class="viewcode-block" id="PlotBlocks.populations"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.PlotBlocks.populations">[docs]</a>    <span class="k">def</span> <span class="nf">populations</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="n">age_sm</span><span class="p">,</span><span class="n">met_sm</span><span class="p">,</span><span class="n">rmax</span><span class="p">,</span><span class="o">**</span><span class="n">kwgs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots and saves radial density profiles, age, metallicity , and f(|W|) distributions, </span>
<span class="sd">        Hess diagrams and Rz-maps for the different populations. </span>
<span class="sd">    </span>
<span class="sd">        :param ages: Set of age bins, Gyr. </span>
<span class="sd">        :type ages: array-like</span>
<span class="sd">        :param mets: Set of meallicity bins. </span>
<span class="sd">        :type mets: array-like</span>
<span class="sd">        :param age_sm: Standard deviation of the Gaussian kernel, which is used </span>
<span class="sd">            to smooth age distributions, Gyr. </span>
<span class="sd">        :type age_sm: scalar  </span>
<span class="sd">        :param met_sm: Standard deviation of the Gaussian kernel, which is used </span>
<span class="sd">            to smooth metallicity distributions. </span>
<span class="sd">        :type met_sm: scalar  </span>
<span class="sd">        :param rmax: Radius of the local sphere or cylinder (for calculation of Hess diagram), pc. </span>
<span class="sd">        :type rmax: scalar</span>
<span class="sd">        :param dz: Optional. Vertical resolution, pc. If not specified, **dz** = 25 pc. </span>
<span class="sd">        :type dz: scalar</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str</span>
<span class="sd">        :param print_time: Optional. If True, calculation time is printed. </span>
<span class="sd">        :type print_time: boolean </span>
<span class="sd">        </span>
<span class="sd">        :return: None. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        
        <span class="n">this_function</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">stack</span><span class="p">()[</span><span class="mi">0</span><span class="p">][</span><span class="mi">3</span><span class="p">]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
            <span class="n">t_start</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        <span class="k">if</span> <span class="s1">&#39;mode_iso&#39;</span> <span class="ow">in</span> <span class="n">kwgs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">kwgs</span><span class="p">[</span><span class="s1">&#39;mode_iso&#39;</span><span class="p">]</span>                          
        
        <span class="n">modes_disk</span> <span class="o">=</span> <span class="s1">&#39;tot&#39;</span>
        
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">)):</span>
            
            <span class="c1"># Density profiles</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">run_mode</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhor_monoage_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="n">between</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                        <span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="k">with</span> <span class="n">warnings</span><span class="o">.</span><span class="n">catch_warnings</span><span class="p">():</span>
                    <span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span><span class="n">category</span><span class="o">=</span><span class="ne">UserWarning</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rhor_monomet_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span>
                                            <span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>        
            <span class="c1"># Ages and metallicities</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">run_mode</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">agehist_rsun_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span>
                                        <span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sigma_gauss</span><span class="o">=</span><span class="n">age_sm</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">methist_rsun_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span>
                                        <span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sigma_gauss</span><span class="o">=</span><span class="n">met_sm</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">agez_rsun_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>  
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">metz_rsun_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>    
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">agehist_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span>
                                   <span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sigma_gauss</span><span class="o">=</span><span class="n">age_sm</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">methist_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span>
                                   <span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="n">sigma_gauss</span><span class="o">=</span><span class="n">met_sm</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">agez_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>  
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">metz_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>    
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">ager_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>            
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">metr_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>        
            
                <span class="c1"># RZ-maps</span>
                <span class="k">if</span> <span class="s1">&#39;dz&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">:</span>
                    <span class="n">dz</span> <span class="o">=</span> <span class="mi">25</span> <span class="c1"># pc </span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">dz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dz&#39;</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rz_map_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="n">dz</span><span class="o">=</span><span class="n">dz</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>                              
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rz_map_quantity_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="s1">&#39;age&#39;</span><span class="p">,</span><span class="n">dz</span><span class="o">=</span><span class="n">dz</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>                                       
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rz_map_quantity_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="s1">&#39;FeH&#39;</span><span class="p">,</span><span class="n">dz</span><span class="o">=</span><span class="n">dz</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>                                       
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">rz_map_quantity_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="s1">&#39;sigw&#39;</span><span class="p">,</span><span class="n">dz</span><span class="o">=</span><span class="n">dz</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>  
            
                <span class="c1"># Kinematics</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">fw_hist_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="o">.</span><span class="n">R</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">[</span><span class="n">l</span><span class="p">],</span><span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                   <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
                
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">fw_hist_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="p">,</span><span class="n">zlim</span><span class="p">,</span><span class="n">mode_pop</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">pops</span><span class="p">,</span><span class="n">number</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="c1"># Hess diagrams</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">hess_simple_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="s1">&#39;local_sphere&#39;</span><span class="p">,[</span><span class="s1">&#39;G_EDR3&#39;</span><span class="p">,</span><span class="s1">&#39;G_EDR3&#39;</span><span class="p">,</span><span class="s1">&#39;GRP_EDR3&#39;</span><span class="p">],</span>
                               <span class="p">[[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">1.5</span><span class="p">],[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">]],[</span><span class="mf">0.005</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span><span class="n">smooth</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span><span class="n">r_minmax</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">rmax</span><span class="p">],</span>
                               <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">hess_simple_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="s1">&#39;local_cylinder&#39;</span><span class="p">,[</span><span class="s1">&#39;G_EDR3&#39;</span><span class="p">,</span><span class="s1">&#39;G_EDR3&#39;</span><span class="p">,</span><span class="s1">&#39;GRP_EDR3&#39;</span><span class="p">],</span>
                               <span class="p">[[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">1.5</span><span class="p">],[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">]],[</span><span class="mf">0.005</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span><span class="n">smooth</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span><span class="n">r_minmax</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">rmax</span><span class="p">],</span>
                               <span class="n">zlim</span><span class="o">=</span><span class="n">zlim</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">run_mode</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">P</span><span class="o">.</span><span class="n">hess_simple_plt</span><span class="p">(</span><span class="n">modes_disk</span><span class="p">,</span><span class="s1">&#39;rphiz_box&#39;</span><span class="p">,[</span><span class="s1">&#39;G_EDR3&#39;</span><span class="p">,</span><span class="s1">&#39;G_EDR3&#39;</span><span class="p">,</span><span class="s1">&#39;GRP_EDR3&#39;</span><span class="p">],</span>
                                   <span class="p">[[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span><span class="mf">1.5</span><span class="p">],[</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">15</span><span class="p">]],[</span><span class="mf">0.005</span><span class="p">,</span><span class="mf">0.1</span><span class="p">],</span><span class="n">smooth</span><span class="o">=</span><span class="p">[</span><span class="mf">0.05</span><span class="p">,</span><span class="mf">0.3</span><span class="p">],</span>
                                   <span class="n">R_minmax</span><span class="o">=</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">Rsun</span><span class="o">+</span><span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">dR</span><span class="o">/</span><span class="mi">2</span><span class="p">],</span>
                                   <span class="n">zlim</span><span class="o">=</span><span class="n">zlim</span><span class="p">,</span><span class="n">dphi</span><span class="o">=</span><span class="mi">360</span><span class="p">,</span><span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="n">inpcheck_iskwargtype</span><span class="p">(</span><span class="n">kwgs</span><span class="p">,</span><span class="s1">&#39;print_time&#39;</span><span class="p">,</span><span class="kc">False</span><span class="p">,</span><span class="nb">bool</span><span class="p">,</span><span class="n">this_function</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">PlotBlocks.pops : &#39;</span><span class="p">,</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">t_start</span><span class="p">))</span></div>
        
        
<div class="viewcode-block" id="PlotBlocks.basic_output"><a class="viewcode-back" href="../../plotting.html#jjmodel.plotting.PlotBlocks.basic_output">[docs]</a>    <span class="k">def</span> <span class="nf">basic_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">zlim_set</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="n">age_sm</span><span class="p">,</span><span class="n">met_sm</span><span class="p">,</span><span class="n">rmax</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots and saves all figures (basic output of the model). </span>
<span class="sd">        </span>
<span class="sd">        :param zlim_set: Edges of z-bins where the quantities will be calculated. </span>
<span class="sd">        :type zlim_set: array-like</span>
<span class="sd">        :param ages: Set of age bins, Gyr. </span>
<span class="sd">        :type ages: array-like</span>
<span class="sd">        :param mets: Set of meallicity bins. </span>
<span class="sd">        :type mets: array-like</span>
<span class="sd">        :param age_sm: Standard deviation of the Gaussian kernel, which is used </span>
<span class="sd">            to smooth age distributions, Gyr. </span>
<span class="sd">        :type age_sm: scalar  </span>
<span class="sd">        :param met_sm: Standard deviation of the Gaussian kernel, which is used </span>
<span class="sd">            to smooth metallicity distributions. </span>
<span class="sd">        :type met_sm: scalar  </span>
<span class="sd">        :param rmax: Radius of the local sphere or cylinder (for calculation of Hess diagram), pc. </span>
<span class="sd">        :type rmax: scalar</span>
<span class="sd">        :param dz: Optional. Vertical resolution for Rz maps, pc. If not specified, **dz** = 25 pc. </span>
<span class="sd">        :type dz: scalar</span>
<span class="sd">        :param mode_iso: Optional. Defines which set of isochrones is used, can be ``&#39;Padova&#39;``, ``&#39;MIST&#39;``, or ``&#39;BaSTI&#39;``. </span>
<span class="sd">            If not specified, Padova is the default isochrone set. </span>
<span class="sd">        :type mode_iso: str</span>
<span class="sd"> </span>
<span class="sd">        :return: None. </span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">timer</span> <span class="o">=</span> <span class="n">Timer</span><span class="p">()</span>
        <span class="n">t_start</span> <span class="o">=</span> <span class="n">timer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Plotting block of figures for the JJ model...&#39;</span><span class="p">,</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{:&lt;26}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Input&#39;</span><span class="p">),</span><span class="s1">&#39;</span><span class="si">{:&lt;2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model_input</span><span class="p">(</span><span class="n">print_time</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">ok&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:&lt;26}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Potential&#39;</span><span class="p">),</span><span class="s1">&#39;</span><span class="si">{:&lt;2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">potential</span><span class="p">(</span><span class="n">print_time</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">ok&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:&lt;26}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Scale heights&#39;</span><span class="p">),</span><span class="s1">&#39;</span><span class="si">{:&lt;2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">heights</span><span class="p">(</span><span class="n">ages</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="n">print_time</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">ok&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:&lt;26}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Densities&#39;</span><span class="p">),</span><span class="s1">&#39;</span><span class="si">{:&lt;2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">densities</span><span class="p">([</span><span class="n">zlim_set</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="n">ages</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="n">print_time</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">ok&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:&lt;26}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Ages&#39;</span><span class="p">),</span><span class="s1">&#39;</span><span class="si">{:&lt;2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ages</span><span class="p">(</span><span class="n">zlim_set</span><span class="p">,</span><span class="n">age_sm</span><span class="p">,</span><span class="n">print_time</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">ok&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:&lt;26}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Metallicities&#39;</span><span class="p">),</span><span class="s1">&#39;</span><span class="si">{:&lt;2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">metallicities</span><span class="p">(</span><span class="n">zlim_set</span><span class="p">,</span><span class="n">met_sm</span><span class="p">,</span><span class="n">print_time</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">ok&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:&lt;26}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Kinematics&#39;</span><span class="p">),</span><span class="s1">&#39;</span><span class="si">{:&lt;2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kinematics</span><span class="p">(</span><span class="n">zlim_set</span><span class="p">,</span><span class="n">ages</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="n">print_time</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">ok&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:&lt;26}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Populations&#39;</span><span class="p">),</span><span class="s1">&#39;</span><span class="si">{:&lt;2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">populations</span><span class="p">([</span><span class="n">zlim_set</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="n">zlim_set</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span><span class="n">ages</span><span class="p">,</span><span class="n">mets</span><span class="p">,</span><span class="n">age_sm</span><span class="p">,</span><span class="n">met_sm</span><span class="p">,</span><span class="n">rmax</span><span class="p">,</span>
                             <span class="n">print_time</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">p</span><span class="o">.</span><span class="n">run_mode</span><span class="o">!=</span><span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">ok&#39;</span><span class="p">,</span><span class="s1">&#39;</span><span class="si">{:&lt;26}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">RZ-maps&#39;</span><span class="p">),</span><span class="s1">&#39;</span><span class="si">{:&lt;2}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">),</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;dz&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">:</span>
                <span class="n">dz</span> <span class="o">=</span> <span class="mi">25</span> <span class="c1">#pc </span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">dz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;dz&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">rz_maps</span><span class="p">(</span><span class="n">dz</span><span class="p">,</span><span class="n">print_time</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>            
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">ok&#39;</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">PlotBlocks.basic_output: &#39;</span><span class="p">,</span><span class="n">timer</span><span class="o">.</span><span class="n">stop</span><span class="p">(</span><span class="n">t_start</span><span class="p">))</span></div></div>


</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../../index.html">jjmodel</a></h1>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../funcs.html">Physical functions (input)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model_core.html">Radial and vertical MW structure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../populations.html">Stellar populations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../geometry.html">Geometry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trans.html">Coordinates and velocities (from data)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tools.html">Useful tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analysis.html">Output analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plotting.html">Plotting tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../acknowledgements.html">Acknowledgements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contacts.html">Authors and contact</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Module code</a><ul>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Sysoliatina.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 3.0.4</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
    </div>

    

    
  </body>
</html>